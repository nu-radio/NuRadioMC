<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Raytrace RK4 Code: RayTraceRK4.C File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Raytrace RK4 Code
   &#160;<span id="projectnumber">1.00</span>
   </div>
   <div id="projectbrief">This code currently traces rays for the South Pole index of refraction model. It uses the Runge Kutta method for that (RK4). It returns a pointer with the launch, recieve and return angle of the ray.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('RayTraceRK4_8C.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">RayTraceRK4.C File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;iostream&gt;</code><br />
<code>#include &lt;fstream&gt;</code><br />
<code>#include &lt;string&gt;</code><br />
<code>#include &quot;TGraph.h&quot;</code><br />
<code>#include &quot;TMath.h&quot;</code><br />
<code>#include &quot;TString.h&quot;</code><br />
<code>#include &quot;TFile.h&quot;</code><br />
<code>#include &quot;TTree.h&quot;</code><br />
<code>#include &quot;TF1.h&quot;</code><br />
<code>#include &quot;../../utilities/units.h&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for RayTraceRK4.C:</div>
<div class="dyncontent">
<div class="center"><img src="RayTraceRK4_8C__incl.png" border="0" usemap="#RayTraceRK4_8C" alt=""/></div>
</div>
</div>
<p><a href="RayTraceRK4_8C_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a1702994504683249f957d9824faa03ea"><td class="memItemLeft" align="right" valign="top">Double_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="RayTraceRK4_8C.html#a1702994504683249f957d9824faa03ea">n</a> (Double_t z)</td></tr>
<tr class="memdesc:a1702994504683249f957d9824faa03ea"><td class="mdescLeft">&#160;</td><td class="mdescRight">Takes in values of A,B &amp; C and the depth z and returns value for refrative index model n(z).  <a href="#a1702994504683249f957d9824faa03ea">More...</a><br /></td></tr>
<tr class="separator:a1702994504683249f957d9824faa03ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9587d130691d8df4eb3f98349e286dc"><td class="memItemLeft" align="right" valign="top">Double_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="RayTraceRK4_8C.html#ab9587d130691d8df4eb3f98349e286dc">dndz</a> (Double_t z)</td></tr>
<tr class="memdesc:ab9587d130691d8df4eb3f98349e286dc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Takes in values of A,B &amp; C and the depth z and returns value for the first derivative of refrative index model.  <a href="#ab9587d130691d8df4eb3f98349e286dc">More...</a><br /></td></tr>
<tr class="separator:ab9587d130691d8df4eb3f98349e286dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e7aa57933d95efc32019bfc6bffd863"><td class="memItemLeft" align="right" valign="top">Double_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="RayTraceRK4_8C.html#a4e7aa57933d95efc32019bfc6bffd863">fx</a> (Double_t theta)</td></tr>
<tr class="memdesc:a4e7aa57933d95efc32019bfc6bffd863"><td class="mdescLeft">&#160;</td><td class="mdescRight">Takes in value of theta (angle w.r.t to the vertical) and calculates the derivative of x w.r.t to length of the step.  <a href="#a4e7aa57933d95efc32019bfc6bffd863">More...</a><br /></td></tr>
<tr class="separator:a4e7aa57933d95efc32019bfc6bffd863"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a973febe1d212427d73db10966b273af4"><td class="memItemLeft" align="right" valign="top">Double_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="RayTraceRK4_8C.html#a973febe1d212427d73db10966b273af4">fz</a> (Double_t theta)</td></tr>
<tr class="memdesc:a973febe1d212427d73db10966b273af4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Takes in value of theta (angle w.r.t to the vertical) and calculates the derivative of depth z w.r.t to length of the step.  <a href="#a973febe1d212427d73db10966b273af4">More...</a><br /></td></tr>
<tr class="separator:a973febe1d212427d73db10966b273af4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc2aaf8313c24c602356e10d240d82ee"><td class="memItemLeft" align="right" valign="top">Double_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="RayTraceRK4_8C.html#abc2aaf8313c24c602356e10d240d82ee">ftheta</a> (Double_t theta, Double_t z)</td></tr>
<tr class="memdesc:abc2aaf8313c24c602356e10d240d82ee"><td class="mdescLeft">&#160;</td><td class="mdescRight">Takes in value of theta (angle w.r.t to the vertical), n(z) and dndz(z) and calculates the derivative of theta w.r.t to length of the step.  <a href="#abc2aaf8313c24c602356e10d240d82ee">More...</a><br /></td></tr>
<tr class="separator:abc2aaf8313c24c602356e10d240d82ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e8e798a5436285f3630ccce025dfb0e"><td class="memItemLeft" align="right" valign="top">Double_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="RayTraceRK4_8C.html#a7e8e798a5436285f3630ccce025dfb0e">temperature</a> (Double_t z)</td></tr>
<tr class="memdesc:a7e8e798a5436285f3630ccce025dfb0e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Takes in value of depth z and returns the value of temperature. This is used in the RK4 calculations.  <a href="#a7e8e798a5436285f3630ccce025dfb0e">More...</a><br /></td></tr>
<tr class="separator:a7e8e798a5436285f3630ccce025dfb0e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae00660ff3fdd0b0d57389488f592539"><td class="memItemLeft" align="right" valign="top">Double_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="RayTraceRK4_8C.html#aae00660ff3fdd0b0d57389488f592539">Latten</a> (Double_t z, Double_t frequency)</td></tr>
<tr class="memdesc:aae00660ff3fdd0b0d57389488f592539"><td class="mdescLeft">&#160;</td><td class="mdescRight">Takes in value of frequency in Ghz and depth z and returns you the value of attenuation length. This is used in the RK4 calculations.  <a href="#aae00660ff3fdd0b0d57389488f592539">More...</a><br /></td></tr>
<tr class="separator:aae00660ff3fdd0b0d57389488f592539"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b88e3189963924bcd9ec97027477b3d"><td class="memItemLeft" align="right" valign="top">Double_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="RayTraceRK4_8C.html#a0b88e3189963924bcd9ec97027477b3d">ftau</a> (Double_t tau, Double_t z, Double_t freq)</td></tr>
<tr class="memdesc:a0b88e3189963924bcd9ec97027477b3d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Takes in the value of depth z and the frequency (in Ghz) and calculates the derivative of amplitude Tau w.r.t to length of the step.  <a href="#a0b88e3189963924bcd9ec97027477b3d">More...</a><br /></td></tr>
<tr class="separator:a0b88e3189963924bcd9ec97027477b3d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a106442644474ea4220dbe0a18e159e86"><td class="memItemLeft" align="right" valign="top">Double_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="RayTraceRK4_8C.html#a106442644474ea4220dbe0a18e159e86">ftime</a> (Double_t z)</td></tr>
<tr class="memdesc:a106442644474ea4220dbe0a18e159e86"><td class="mdescLeft">&#160;</td><td class="mdescRight">Takes in the value of depth z and calculates the derivative of time w.r.t to length of the step.  <a href="#a106442644474ea4220dbe0a18e159e86">More...</a><br /></td></tr>
<tr class="separator:a106442644474ea4220dbe0a18e159e86"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5e3f9f446f6172ec75e60456487ca3c"><td class="memItemLeft" align="right" valign="top">Double_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="RayTraceRK4_8C.html#ae5e3f9f446f6172ec75e60456487ca3c">getDirAng</a> (Double_t x0, Double_t z0, Double_t x1, Double_t z1)</td></tr>
<tr class="memdesc:ae5e3f9f446f6172ec75e60456487ca3c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Takes in the value of Tx (x0,z0) and Rx (x1,z1) coordinates and calculates a guess for the launch angle of the Direct ray.  <a href="#ae5e3f9f446f6172ec75e60456487ca3c">More...</a><br /></td></tr>
<tr class="separator:ae5e3f9f446f6172ec75e60456487ca3c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf18e16d4be5e4e421640012a3356a38"><td class="memItemLeft" align="right" valign="top">Double_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="RayTraceRK4_8C.html#adf18e16d4be5e4e421640012a3356a38">getReflAng</a> (Double_t x0, Double_t z0, Double_t x1, Double_t z1)</td></tr>
<tr class="memdesc:adf18e16d4be5e4e421640012a3356a38"><td class="mdescLeft">&#160;</td><td class="mdescRight">Takes in the value of Tx (x0,z0) and Rx (x1,z1) coordinates and calculates a guess for the launch angle of the Reflected or Refracted ray.  <a href="#adf18e16d4be5e4e421640012a3356a38">More...</a><br /></td></tr>
<tr class="separator:adf18e16d4be5e4e421640012a3356a38"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adbd350e958beadff13a5460dc9368740"><td class="memItemLeft" align="right" valign="top">Double_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="RayTraceRK4_8C.html#adbd350e958beadff13a5460dc9368740">getStartAngles</a> (Double_t x0, Double_t z0, Double_t x1, Double_t z1, Int_t solnum)</td></tr>
<tr class="memdesc:adbd350e958beadff13a5460dc9368740"><td class="mdescLeft">&#160;</td><td class="mdescRight">Takes in the value of Tx (x0,z0) and Rx (x1,z1) coordinates and calculates a guess for the start launch angle of whatever type of ray you are working with.  <a href="#adbd350e958beadff13a5460dc9368740">More...</a><br /></td></tr>
<tr class="separator:adbd350e958beadff13a5460dc9368740"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8e36e593e5ce8626d334c72466dbac6"><td class="memItemLeft" align="right" valign="top">Double_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="RayTraceRK4_8C.html#ab8e36e593e5ce8626d334c72466dbac6">getAngleCorrections</a> (Int_t num, Int_t antco, Int_t D56co, Double_t test0, Double_t test1, Int_t psns, Int_t in, Int_t solnum)</td></tr>
<tr class="memdesc:ab8e36e593e5ce8626d334c72466dbac6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Takes in the value of Tx (x0,z0) and Rx (x1,z1) coordinates and corrects/adjusts the launch angles based on the accuracy of the guess.  <a href="#ab8e36e593e5ce8626d334c72466dbac6">More...</a><br /></td></tr>
<tr class="separator:ab8e36e593e5ce8626d334c72466dbac6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae524948803cf17eca25b0cd2ba17dc29"><td class="memItemLeft" align="right" valign="top">Double_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="RayTraceRK4_8C.html#ae524948803cf17eca25b0cd2ba17dc29">RayTraceRK4</a> (Double_t c1, Double_t c2, Double_t c3, Double_t r1, Double_t r2, Double_t r3, Int_t wsol, Double_t *frequency, Int_t tausize)</td></tr>
<tr class="memdesc:ae524948803cf17eca25b0cd2ba17dc29"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is the main function where all the calculations are done using the RK4 method. This function takes in the values of:  <a href="#ae524948803cf17eca25b0cd2ba17dc29">More...</a><br /></td></tr>
<tr class="separator:ae524948803cf17eca25b0cd2ba17dc29"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a615dac8ee3d3e28f8224aa4f3131c701"><td class="memItemLeft" align="right" valign="top">const Double_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a> =4.0*atan(1.0)</td></tr>
<tr class="separator:a615dac8ee3d3e28f8224aa4f3131c701"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4879d249821eef77017dddd45d973a84"><td class="memItemLeft" align="right" valign="top">const Double_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="RayTraceRK4_8C.html#a4879d249821eef77017dddd45d973a84">spedc</a> =299792458.0</td></tr>
<tr class="separator:a4879d249821eef77017dddd45d973a84"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aabbd1667d2631d1bf5e1302879450077"><td class="memItemLeft" align="right" valign="top">Double_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="RayTraceRK4_8C.html#aabbd1667d2631d1bf5e1302879450077">h</a> =1*utl::mm</td></tr>
<tr class="separator:aabbd1667d2631d1bf5e1302879450077"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01087fe32e34ceaff1dcd8a4a1bafb5e"><td class="memItemLeft" align="right" valign="top">const Double_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="RayTraceRK4_8C.html#a01087fe32e34ceaff1dcd8a4a1bafb5e">tmax</a> =10*utl::km</td></tr>
<tr class="separator:a01087fe32e34ceaff1dcd8a4a1bafb5e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7bee49b33affb6de35e7dd6787a7d1ff"><td class="memItemLeft" align="right" valign="top">const Double_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="RayTraceRK4_8C.html#a7bee49b33affb6de35e7dd6787a7d1ff">A</a> =1.78</td></tr>
<tr class="separator:a7bee49b33affb6de35e7dd6787a7d1ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3bff7602e1f23fa6422ebf501370116c"><td class="memItemLeft" align="right" valign="top">const Double_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="RayTraceRK4_8C.html#a3bff7602e1f23fa6422ebf501370116c">B</a> =-0.43</td></tr>
<tr class="separator:a3bff7602e1f23fa6422ebf501370116c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef13ddd41f7e49a80e7475962eecfb19"><td class="memItemLeft" align="right" valign="top">const Double_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="RayTraceRK4_8C.html#aef13ddd41f7e49a80e7475962eecfb19">C</a> =0.0132</td></tr>
<tr class="separator:aef13ddd41f7e49a80e7475962eecfb19"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a1702994504683249f957d9824faa03ea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1702994504683249f957d9824faa03ea">&#9670;&nbsp;</a></span>n()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Double_t n </td>
          <td>(</td>
          <td class="paramtype">Double_t&#160;</td>
          <td class="paramname"><em>z</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Takes in values of A,B &amp; C and the depth z and returns value for refrative index model n(z). </p>

<p class="definition">Definition at line <a class="el" href="RayTraceRK4_8C_source.html#l00892">892</a> of file <a class="el" href="RayTraceRK4_8C_source.html">RayTraceRK4.C</a>.</p>

<p class="reference">References <a class="el" href="RayTraceRK4_8C_source.html#l00020">A</a>, <a class="el" href="RayTraceRK4_8C_source.html#l00021">B</a>, and <a class="el" href="RayTraceRK4_8C_source.html#l00022">C</a>.</p>

<p class="reference">Referenced by <a class="el" href="RayTraceRK4_8C_source.html#l00908">ftheta()</a>, <a class="el" href="RayTraceRK4_8C_source.html#l00942">ftime()</a>, and <a class="el" href="RayTraceRK4_8C_source.html#l00947">getDirAng()</a>.</p>
<div class="fragment"><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;                      {</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="RayTraceRK4_8C.html#a7bee49b33affb6de35e7dd6787a7d1ff">A</a>+<a class="code" href="RayTraceRK4_8C.html#a3bff7602e1f23fa6422ebf501370116c">B</a>*exp(<a class="code" href="RayTraceRK4_8C.html#aef13ddd41f7e49a80e7475962eecfb19">C</a>*z);</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;}</div><div class="ttc" id="RayTraceRK4_8C_html_aef13ddd41f7e49a80e7475962eecfb19"><div class="ttname"><a href="RayTraceRK4_8C.html#aef13ddd41f7e49a80e7475962eecfb19">C</a></div><div class="ttdeci">const Double_t C</div><div class="ttdef"><b>Definition:</b> <a href="RayTraceRK4_8C_source.html#l00022">RayTraceRK4.C:22</a></div></div>
<div class="ttc" id="RayTraceRK4_8C_html_a7bee49b33affb6de35e7dd6787a7d1ff"><div class="ttname"><a href="RayTraceRK4_8C.html#a7bee49b33affb6de35e7dd6787a7d1ff">A</a></div><div class="ttdeci">const Double_t A</div><div class="ttdef"><b>Definition:</b> <a href="RayTraceRK4_8C_source.html#l00020">RayTraceRK4.C:20</a></div></div>
<div class="ttc" id="RayTraceRK4_8C_html_a3bff7602e1f23fa6422ebf501370116c"><div class="ttname"><a href="RayTraceRK4_8C.html#a3bff7602e1f23fa6422ebf501370116c">B</a></div><div class="ttdeci">const Double_t B</div><div class="ttdef"><b>Definition:</b> <a href="RayTraceRK4_8C_source.html#l00021">RayTraceRK4.C:21</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="RayTraceRK4_8C_a1702994504683249f957d9824faa03ea_icgraph.png" border="0" usemap="#RayTraceRK4_8C_a1702994504683249f957d9824faa03ea_icgraph" alt=""/></div>
<map name="RayTraceRK4_8C_a1702994504683249f957d9824faa03ea_icgraph" id="RayTraceRK4_8C_a1702994504683249f957d9824faa03ea_icgraph">
<area shape="rect" id="node2" href="RayTraceRK4_8C.html#abc2aaf8313c24c602356e10d240d82ee" title="Takes in value of theta (angle w.r.t to the vertical), n(z) and dndz(z) and calculates the derivative..." alt="" coords="247,5,301,32"/>
<area shape="rect" id="node4" href="RayTraceRK4_8C.html#a106442644474ea4220dbe0a18e159e86" title="Takes in the value of depth z and calculates the derivative of time w.r.t to length of the step..." alt="" coords="107,56,157,83"/>
<area shape="rect" id="node5" href="RayTraceRK4_8C.html#ae5e3f9f446f6172ec75e60456487ca3c" title="Takes in the value of Tx (x0,z0) and Rx (x1,z1) coordinates and calculates a guess for the launch ang..." alt="" coords="92,107,172,133"/>
<area shape="rect" id="node3" href="RayTraceRK4_8C.html#ae524948803cf17eca25b0cd2ba17dc29" title="This is the main function where all the calculations are done using the RK4 method. This function takes in the values of: " alt="" coords="376,56,481,83"/>
<area shape="rect" id="node6" href="RayTraceRK4_8C.html#adbd350e958beadff13a5460dc9368740" title="Takes in the value of Tx (x0,z0) and Rx (x1,z1) coordinates and calculates a guess for the start laun..." alt="" coords="220,107,328,133"/>
</map>
</div>

</div>
</div>
<a id="ab9587d130691d8df4eb3f98349e286dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab9587d130691d8df4eb3f98349e286dc">&#9670;&nbsp;</a></span>dndz()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Double_t dndz </td>
          <td>(</td>
          <td class="paramtype">Double_t&#160;</td>
          <td class="paramname"><em>z</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Takes in values of A,B &amp; C and the depth z and returns value for the first derivative of refrative index model. </p>

<p class="definition">Definition at line <a class="el" href="RayTraceRK4_8C_source.html#l00896">896</a> of file <a class="el" href="RayTraceRK4_8C_source.html">RayTraceRK4.C</a>.</p>

<p class="reference">References <a class="el" href="RayTraceRK4_8C_source.html#l00021">B</a>, and <a class="el" href="RayTraceRK4_8C_source.html#l00022">C</a>.</p>

<p class="reference">Referenced by <a class="el" href="RayTraceRK4_8C_source.html#l00908">ftheta()</a>.</p>
<div class="fragment"><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;                         {</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="RayTraceRK4_8C.html#a3bff7602e1f23fa6422ebf501370116c">B</a>*<a class="code" href="RayTraceRK4_8C.html#aef13ddd41f7e49a80e7475962eecfb19">C</a>*exp(<a class="code" href="RayTraceRK4_8C.html#aef13ddd41f7e49a80e7475962eecfb19">C</a>*z);</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;}</div><div class="ttc" id="RayTraceRK4_8C_html_aef13ddd41f7e49a80e7475962eecfb19"><div class="ttname"><a href="RayTraceRK4_8C.html#aef13ddd41f7e49a80e7475962eecfb19">C</a></div><div class="ttdeci">const Double_t C</div><div class="ttdef"><b>Definition:</b> <a href="RayTraceRK4_8C_source.html#l00022">RayTraceRK4.C:22</a></div></div>
<div class="ttc" id="RayTraceRK4_8C_html_a3bff7602e1f23fa6422ebf501370116c"><div class="ttname"><a href="RayTraceRK4_8C.html#a3bff7602e1f23fa6422ebf501370116c">B</a></div><div class="ttdeci">const Double_t B</div><div class="ttdef"><b>Definition:</b> <a href="RayTraceRK4_8C_source.html#l00021">RayTraceRK4.C:21</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="RayTraceRK4_8C_ab9587d130691d8df4eb3f98349e286dc_icgraph.png" border="0" usemap="#RayTraceRK4_8C_ab9587d130691d8df4eb3f98349e286dc_icgraph" alt=""/></div>
<map name="RayTraceRK4_8C_ab9587d130691d8df4eb3f98349e286dc_icgraph" id="RayTraceRK4_8C_ab9587d130691d8df4eb3f98349e286dc_icgraph">
<area shape="rect" id="node2" href="RayTraceRK4_8C.html#abc2aaf8313c24c602356e10d240d82ee" title="Takes in value of theta (angle w.r.t to the vertical), n(z) and dndz(z) and calculates the derivative..." alt="" coords="104,5,159,32"/>
<area shape="rect" id="node3" href="RayTraceRK4_8C.html#ae524948803cf17eca25b0cd2ba17dc29" title="This is the main function where all the calculations are done using the RK4 method. This function takes in the values of: " alt="" coords="207,5,312,32"/>
</map>
</div>

</div>
</div>
<a id="a4e7aa57933d95efc32019bfc6bffd863"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4e7aa57933d95efc32019bfc6bffd863">&#9670;&nbsp;</a></span>fx()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Double_t fx </td>
          <td>(</td>
          <td class="paramtype">Double_t&#160;</td>
          <td class="paramname"><em>theta</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Takes in value of theta (angle w.r.t to the vertical) and calculates the derivative of x w.r.t to length of the step. </p>
<p class="">Basically it helps calculate the value of x in each step in the RK4 calculations. </p>

<p class="definition">Definition at line <a class="el" href="RayTraceRK4_8C_source.html#l00900">900</a> of file <a class="el" href="RayTraceRK4_8C_source.html">RayTraceRK4.C</a>.</p>

<p class="reference">Referenced by <a class="el" href="RayTraceRK4_8C_source.html#l00183">RayTraceRK4()</a>.</p>
<div class="fragment"><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;                           {</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;  <span class="keywordflow">return</span> sin(theta);</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;}</div></div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="RayTraceRK4_8C_a4e7aa57933d95efc32019bfc6bffd863_icgraph.png" border="0" usemap="#RayTraceRK4_8C_a4e7aa57933d95efc32019bfc6bffd863_icgraph" alt=""/></div>
<map name="RayTraceRK4_8C_a4e7aa57933d95efc32019bfc6bffd863_icgraph" id="RayTraceRK4_8C_a4e7aa57933d95efc32019bfc6bffd863_icgraph">
<area shape="rect" id="node2" href="RayTraceRK4_8C.html#ae524948803cf17eca25b0cd2ba17dc29" title="This is the main function where all the calculations are done using the RK4 method. This function takes in the values of: " alt="" coords="92,5,197,32"/>
</map>
</div>

</div>
</div>
<a id="a973febe1d212427d73db10966b273af4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a973febe1d212427d73db10966b273af4">&#9670;&nbsp;</a></span>fz()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Double_t fz </td>
          <td>(</td>
          <td class="paramtype">Double_t&#160;</td>
          <td class="paramname"><em>theta</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Takes in value of theta (angle w.r.t to the vertical) and calculates the derivative of depth z w.r.t to length of the step. </p>
<p class="">Basically it helps calculate the value of depth z in each step in the RK4 calculations. </p>

<p class="definition">Definition at line <a class="el" href="RayTraceRK4_8C_source.html#l00904">904</a> of file <a class="el" href="RayTraceRK4_8C_source.html">RayTraceRK4.C</a>.</p>

<p class="reference">Referenced by <a class="el" href="RayTraceRK4_8C_source.html#l00183">RayTraceRK4()</a>.</p>
<div class="fragment"><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;                           {  </div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;  <span class="keywordflow">return</span> cos(theta);</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;}</div></div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="RayTraceRK4_8C_a973febe1d212427d73db10966b273af4_icgraph.png" border="0" usemap="#RayTraceRK4_8C_a973febe1d212427d73db10966b273af4_icgraph" alt=""/></div>
<map name="RayTraceRK4_8C_a973febe1d212427d73db10966b273af4_icgraph" id="RayTraceRK4_8C_a973febe1d212427d73db10966b273af4_icgraph">
<area shape="rect" id="node2" href="RayTraceRK4_8C.html#ae524948803cf17eca25b0cd2ba17dc29" title="This is the main function where all the calculations are done using the RK4 method. This function takes in the values of: " alt="" coords="92,5,197,32"/>
</map>
</div>

</div>
</div>
<a id="abc2aaf8313c24c602356e10d240d82ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc2aaf8313c24c602356e10d240d82ee">&#9670;&nbsp;</a></span>ftheta()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Double_t ftheta </td>
          <td>(</td>
          <td class="paramtype">Double_t&#160;</td>
          <td class="paramname"><em>theta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Double_t&#160;</td>
          <td class="paramname"><em>z</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Takes in value of theta (angle w.r.t to the vertical), n(z) and dndz(z) and calculates the derivative of theta w.r.t to length of the step. </p>
<p class="">Basically it helps calculate the value of theta in each step in the RK4 calculations. </p>

<p class="definition">Definition at line <a class="el" href="RayTraceRK4_8C_source.html#l00908">908</a> of file <a class="el" href="RayTraceRK4_8C_source.html">RayTraceRK4.C</a>.</p>

<p class="reference">References <a class="el" href="RayTraceRK4_8C_source.html#l00896">dndz()</a>, and <a class="el" href="RayTraceRK4_8C_source.html#l00892">n()</a>.</p>

<p class="reference">Referenced by <a class="el" href="RayTraceRK4_8C_source.html#l00183">RayTraceRK4()</a>.</p>
<div class="fragment"><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;                                           {  </div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;  <span class="keywordflow">return</span> -sin(theta)*(1.0/<a class="code" href="RayTraceRK4_8C.html#a1702994504683249f957d9824faa03ea">n</a>(z))*<a class="code" href="RayTraceRK4_8C.html#ab9587d130691d8df4eb3f98349e286dc">dndz</a>(z);</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;}</div><div class="ttc" id="RayTraceRK4_8C_html_a1702994504683249f957d9824faa03ea"><div class="ttname"><a href="RayTraceRK4_8C.html#a1702994504683249f957d9824faa03ea">n</a></div><div class="ttdeci">Double_t n(Double_t z)</div><div class="ttdoc">Takes in values of A,B &amp; C and the depth z and returns value for refrative index model n(z)...</div><div class="ttdef"><b>Definition:</b> <a href="RayTraceRK4_8C_source.html#l00892">RayTraceRK4.C:892</a></div></div>
<div class="ttc" id="RayTraceRK4_8C_html_ab9587d130691d8df4eb3f98349e286dc"><div class="ttname"><a href="RayTraceRK4_8C.html#ab9587d130691d8df4eb3f98349e286dc">dndz</a></div><div class="ttdeci">Double_t dndz(Double_t z)</div><div class="ttdoc">Takes in values of A,B &amp; C and the depth z and returns value for the first derivative of refrative in...</div><div class="ttdef"><b>Definition:</b> <a href="RayTraceRK4_8C_source.html#l00896">RayTraceRK4.C:896</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="RayTraceRK4_8C_abc2aaf8313c24c602356e10d240d82ee_cgraph.png" border="0" usemap="#RayTraceRK4_8C_abc2aaf8313c24c602356e10d240d82ee_cgraph" alt=""/></div>
<map name="RayTraceRK4_8C_abc2aaf8313c24c602356e10d240d82ee_cgraph" id="RayTraceRK4_8C_abc2aaf8313c24c602356e10d240d82ee_cgraph">
<area shape="rect" id="node2" href="RayTraceRK4_8C.html#ab9587d130691d8df4eb3f98349e286dc" title="Takes in values of A,B &amp; C and the depth z and returns value for the first derivative of refrative in..." alt="" coords="108,5,159,32"/>
<area shape="rect" id="node3" href="RayTraceRK4_8C.html#a1702994504683249f957d9824faa03ea" title="Takes in values of A,B &amp; C and the depth z and returns value for refrative index model n(z)..." alt="" coords="114,56,153,83"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="RayTraceRK4_8C_abc2aaf8313c24c602356e10d240d82ee_icgraph.png" border="0" usemap="#RayTraceRK4_8C_abc2aaf8313c24c602356e10d240d82ee_icgraph" alt=""/></div>
<map name="RayTraceRK4_8C_abc2aaf8313c24c602356e10d240d82ee_icgraph" id="RayTraceRK4_8C_abc2aaf8313c24c602356e10d240d82ee_icgraph">
<area shape="rect" id="node2" href="RayTraceRK4_8C.html#ae524948803cf17eca25b0cd2ba17dc29" title="This is the main function where all the calculations are done using the RK4 method. This function takes in the values of: " alt="" coords="108,5,213,32"/>
</map>
</div>

</div>
</div>
<a id="a7e8e798a5436285f3630ccce025dfb0e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7e8e798a5436285f3630ccce025dfb0e">&#9670;&nbsp;</a></span>temperature()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Double_t temperature </td>
          <td>(</td>
          <td class="paramtype">Double_t&#160;</td>
          <td class="paramname"><em>z</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Takes in value of depth z and returns the value of temperature. This is used in the RK4 calculations. </p>
<p class="">The temperature model has been taken from AraSim which also took it from here <a href="http://icecube.wisc.edu/~mnewcomb/radio/atten/">http://icecube.wisc.edu/~mnewcomb/radio/atten/</a> . This is basically Matt Newcomb's icecube directory which has alot of information, plots and codes about South Pole Ice activities. Please read it if you find it interesting. <a href="http://icecube.wisc.edu/~mnewcomb/radio/#iceabsorbtion">http://icecube.wisc.edu/~mnewcomb/radio/#iceabsorbtion</a> </p>

<p class="definition">Definition at line <a class="el" href="RayTraceRK4_8C_source.html#l00912">912</a> of file <a class="el" href="RayTraceRK4_8C_source.html">RayTraceRK4.C</a>.</p>

<p class="reference">Referenced by <a class="el" href="RayTraceRK4_8C_source.html#l00916">Latten()</a>.</p>
<div class="fragment"><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;                                {</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;    <span class="keywordflow">return</span>(-51.5 + z*(-4.5319e-3 + 5.822e-6*z));</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;}</div></div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="RayTraceRK4_8C_a7e8e798a5436285f3630ccce025dfb0e_icgraph.png" border="0" usemap="#RayTraceRK4_8C_a7e8e798a5436285f3630ccce025dfb0e_icgraph" alt=""/></div>
<map name="RayTraceRK4_8C_a7e8e798a5436285f3630ccce025dfb0e_icgraph" id="RayTraceRK4_8C_a7e8e798a5436285f3630ccce025dfb0e_icgraph">
<area shape="rect" id="node2" href="RayTraceRK4_8C.html#aae00660ff3fdd0b0d57389488f592539" title="Takes in value of frequency in Ghz and depth z and returns you the value of attenuation length..." alt="" coords="144,5,203,32"/>
<area shape="rect" id="node3" href="RayTraceRK4_8C.html#a0b88e3189963924bcd9ec97027477b3d" title="Takes in the value of depth z and the frequency (in Ghz) and calculates the derivative of amplitude T..." alt="" coords="251,5,295,32"/>
<area shape="rect" id="node4" href="RayTraceRK4_8C.html#ae524948803cf17eca25b0cd2ba17dc29" title="This is the main function where all the calculations are done using the RK4 method. This function takes in the values of: " alt="" coords="343,5,448,32"/>
</map>
</div>

</div>
</div>
<a id="aae00660ff3fdd0b0d57389488f592539"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae00660ff3fdd0b0d57389488f592539">&#9670;&nbsp;</a></span>Latten()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Double_t Latten </td>
          <td>(</td>
          <td class="paramtype">Double_t&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Double_t&#160;</td>
          <td class="paramname"><em>frequency</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Takes in value of frequency in Ghz and depth z and returns you the value of attenuation length. This is used in the RK4 calculations. </p>

<p class="definition">Definition at line <a class="el" href="RayTraceRK4_8C_source.html#l00916">916</a> of file <a class="el" href="RayTraceRK4_8C_source.html">RayTraceRK4.C</a>.</p>

<p class="reference">References <a class="el" href="RayTraceRK4_8C_source.html#l00912">temperature()</a>.</p>

<p class="reference">Referenced by <a class="el" href="RayTraceRK4_8C_source.html#l00936">ftau()</a>.</p>
<div class="fragment"><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;                                               {</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;  <span class="comment">//    if(z&gt;0.0)       return(std::numeric_limits&lt;Double_t&gt;::infinity());</span></div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;  Double_t t = <a class="code" href="RayTraceRK4_8C.html#a7e8e798a5436285f3630ccce025dfb0e">temperature</a>(z);</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;  <span class="keyword">const</span> Double_t f0=0.0001, f2=3.16;</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;  <span class="keyword">const</span> Double_t w0=log(f0), w1=0.0, w2=log(f2), w=log(frequency);</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;  <span class="keyword">const</span> Double_t b0=-6.74890+t*(0.026709-t*0.000884);</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;  <span class="keyword">const</span> Double_t b1=-6.22121-t*(0.070927+t*0.001773);</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;  <span class="keyword">const</span> Double_t b2=-4.09468-t*(0.002213+t*0.000332);</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;  Double_t a,bb;</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;  <span class="keywordflow">if</span>(frequency&lt;1.){</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;    a=(b1*w0-b0*w1)/(w0-w1);</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;    bb=(b1-b0)/(w1-w0);</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;  }</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;  <span class="keywordflow">else</span>{</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;    a=(b2*w1-b1*w2)/(w1-w2);</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;    bb=(b2-b1)/(w2-w1);</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;  }</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;  <span class="keywordflow">return</span> 1./exp(a+bb*w);</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;}</div><div class="ttc" id="RayTraceRK4_8C_html_a7e8e798a5436285f3630ccce025dfb0e"><div class="ttname"><a href="RayTraceRK4_8C.html#a7e8e798a5436285f3630ccce025dfb0e">temperature</a></div><div class="ttdeci">Double_t temperature(Double_t z)</div><div class="ttdoc">Takes in value of depth z and returns the value of temperature. This is used in the RK4 calculations...</div><div class="ttdef"><b>Definition:</b> <a href="RayTraceRK4_8C_source.html#l00912">RayTraceRK4.C:912</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="RayTraceRK4_8C_aae00660ff3fdd0b0d57389488f592539_cgraph.png" border="0" usemap="#RayTraceRK4_8C_aae00660ff3fdd0b0d57389488f592539_cgraph" alt=""/></div>
<map name="RayTraceRK4_8C_aae00660ff3fdd0b0d57389488f592539_cgraph" id="RayTraceRK4_8C_aae00660ff3fdd0b0d57389488f592539_cgraph">
<area shape="rect" id="node2" href="RayTraceRK4_8C.html#a7e8e798a5436285f3630ccce025dfb0e" title="Takes in value of depth z and returns the value of temperature. This is used in the RK4 calculations..." alt="" coords="112,5,203,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="RayTraceRK4_8C_aae00660ff3fdd0b0d57389488f592539_icgraph.png" border="0" usemap="#RayTraceRK4_8C_aae00660ff3fdd0b0d57389488f592539_icgraph" alt=""/></div>
<map name="RayTraceRK4_8C_aae00660ff3fdd0b0d57389488f592539_icgraph" id="RayTraceRK4_8C_aae00660ff3fdd0b0d57389488f592539_icgraph">
<area shape="rect" id="node2" href="RayTraceRK4_8C.html#a0b88e3189963924bcd9ec97027477b3d" title="Takes in the value of depth z and the frequency (in Ghz) and calculates the derivative of amplitude T..." alt="" coords="112,5,156,32"/>
<area shape="rect" id="node3" href="RayTraceRK4_8C.html#ae524948803cf17eca25b0cd2ba17dc29" title="This is the main function where all the calculations are done using the RK4 method. This function takes in the values of: " alt="" coords="204,5,309,32"/>
</map>
</div>

</div>
</div>
<a id="a0b88e3189963924bcd9ec97027477b3d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b88e3189963924bcd9ec97027477b3d">&#9670;&nbsp;</a></span>ftau()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Double_t ftau </td>
          <td>(</td>
          <td class="paramtype">Double_t&#160;</td>
          <td class="paramname"><em>tau</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Double_t&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Double_t&#160;</td>
          <td class="paramname"><em>freq</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Takes in the value of depth z and the frequency (in Ghz) and calculates the derivative of amplitude Tau w.r.t to length of the step. </p>
<p class="">Basically it helps calculate that how much will the amplitude be attenuated at the specified frequency in each step at of the RK4 calculations </p>

<p class="definition">Definition at line <a class="el" href="RayTraceRK4_8C_source.html#l00936">936</a> of file <a class="el" href="RayTraceRK4_8C_source.html">RayTraceRK4.C</a>.</p>

<p class="reference">References <a class="el" href="RayTraceRK4_8C_source.html#l00916">Latten()</a>.</p>

<p class="reference">Referenced by <a class="el" href="RayTraceRK4_8C_source.html#l00183">RayTraceRK4()</a>.</p>
<div class="fragment"><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;                                                     {  </div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;  <span class="comment">// Double_t Latten=1000;</span></div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;  Double_t Lval=<a class="code" href="RayTraceRK4_8C.html#aae00660ff3fdd0b0d57389488f592539">Latten</a>(z,freq);</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;  <span class="keywordflow">return</span> tau/Lval;</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;}</div><div class="ttc" id="RayTraceRK4_8C_html_aae00660ff3fdd0b0d57389488f592539"><div class="ttname"><a href="RayTraceRK4_8C.html#aae00660ff3fdd0b0d57389488f592539">Latten</a></div><div class="ttdeci">Double_t Latten(Double_t z, Double_t frequency)</div><div class="ttdoc">Takes in value of frequency in Ghz and depth z and returns you the value of attenuation length...</div><div class="ttdef"><b>Definition:</b> <a href="RayTraceRK4_8C_source.html#l00916">RayTraceRK4.C:916</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="RayTraceRK4_8C_a0b88e3189963924bcd9ec97027477b3d_cgraph.png" border="0" usemap="#RayTraceRK4_8C_a0b88e3189963924bcd9ec97027477b3d_cgraph" alt=""/></div>
<map name="RayTraceRK4_8C_a0b88e3189963924bcd9ec97027477b3d_cgraph" id="RayTraceRK4_8C_a0b88e3189963924bcd9ec97027477b3d_cgraph">
<area shape="rect" id="node2" href="RayTraceRK4_8C.html#aae00660ff3fdd0b0d57389488f592539" title="Takes in value of frequency in Ghz and depth z and returns you the value of attenuation length..." alt="" coords="97,5,156,32"/>
<area shape="rect" id="node3" href="RayTraceRK4_8C.html#a7e8e798a5436285f3630ccce025dfb0e" title="Takes in value of depth z and returns the value of temperature. This is used in the RK4 calculations..." alt="" coords="204,5,295,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="RayTraceRK4_8C_a0b88e3189963924bcd9ec97027477b3d_icgraph.png" border="0" usemap="#RayTraceRK4_8C_a0b88e3189963924bcd9ec97027477b3d_icgraph" alt=""/></div>
<map name="RayTraceRK4_8C_a0b88e3189963924bcd9ec97027477b3d_icgraph" id="RayTraceRK4_8C_a0b88e3189963924bcd9ec97027477b3d_icgraph">
<area shape="rect" id="node2" href="RayTraceRK4_8C.html#ae524948803cf17eca25b0cd2ba17dc29" title="This is the main function where all the calculations are done using the RK4 method. This function takes in the values of: " alt="" coords="97,5,203,32"/>
</map>
</div>

</div>
</div>
<a id="a106442644474ea4220dbe0a18e159e86"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a106442644474ea4220dbe0a18e159e86">&#9670;&nbsp;</a></span>ftime()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Double_t ftime </td>
          <td>(</td>
          <td class="paramtype">Double_t&#160;</td>
          <td class="paramname"><em>z</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Takes in the value of depth z and calculates the derivative of time w.r.t to length of the step. </p>
<p class="">Basically it helps calculate the value of time in each step in the RK4 calculations. </p>

<p class="definition">Definition at line <a class="el" href="RayTraceRK4_8C_source.html#l00942">942</a> of file <a class="el" href="RayTraceRK4_8C_source.html">RayTraceRK4.C</a>.</p>

<p class="reference">References <a class="el" href="RayTraceRK4_8C_source.html#l00892">n()</a>, and <a class="el" href="RayTraceRK4_8C_source.html#l00014">spedc</a>.</p>

<p class="reference">Referenced by <a class="el" href="RayTraceRK4_8C_source.html#l00183">RayTraceRK4()</a>.</p>
<div class="fragment"><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;                          {  </div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="RayTraceRK4_8C.html#a1702994504683249f957d9824faa03ea">n</a>(z)/<a class="code" href="RayTraceRK4_8C.html#a4879d249821eef77017dddd45d973a84">spedc</a>;</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;}</div><div class="ttc" id="RayTraceRK4_8C_html_a1702994504683249f957d9824faa03ea"><div class="ttname"><a href="RayTraceRK4_8C.html#a1702994504683249f957d9824faa03ea">n</a></div><div class="ttdeci">Double_t n(Double_t z)</div><div class="ttdoc">Takes in values of A,B &amp; C and the depth z and returns value for refrative index model n(z)...</div><div class="ttdef"><b>Definition:</b> <a href="RayTraceRK4_8C_source.html#l00892">RayTraceRK4.C:892</a></div></div>
<div class="ttc" id="RayTraceRK4_8C_html_a4879d249821eef77017dddd45d973a84"><div class="ttname"><a href="RayTraceRK4_8C.html#a4879d249821eef77017dddd45d973a84">spedc</a></div><div class="ttdeci">const Double_t spedc</div><div class="ttdef"><b>Definition:</b> <a href="RayTraceRK4_8C_source.html#l00014">RayTraceRK4.C:14</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="RayTraceRK4_8C_a106442644474ea4220dbe0a18e159e86_cgraph.png" border="0" usemap="#RayTraceRK4_8C_a106442644474ea4220dbe0a18e159e86_cgraph" alt=""/></div>
<map name="RayTraceRK4_8C_a106442644474ea4220dbe0a18e159e86_cgraph" id="RayTraceRK4_8C_a106442644474ea4220dbe0a18e159e86_cgraph">
<area shape="rect" id="node2" href="RayTraceRK4_8C.html#a1702994504683249f957d9824faa03ea" title="Takes in values of A,B &amp; C and the depth z and returns value for refrative index model n(z)..." alt="" coords="104,5,143,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="RayTraceRK4_8C_a106442644474ea4220dbe0a18e159e86_icgraph.png" border="0" usemap="#RayTraceRK4_8C_a106442644474ea4220dbe0a18e159e86_icgraph" alt=""/></div>
<map name="RayTraceRK4_8C_a106442644474ea4220dbe0a18e159e86_icgraph" id="RayTraceRK4_8C_a106442644474ea4220dbe0a18e159e86_icgraph">
<area shape="rect" id="node2" href="RayTraceRK4_8C.html#ae524948803cf17eca25b0cd2ba17dc29" title="This is the main function where all the calculations are done using the RK4 method. This function takes in the values of: " alt="" coords="104,5,209,32"/>
</map>
</div>

</div>
</div>
<a id="ae5e3f9f446f6172ec75e60456487ca3c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae5e3f9f446f6172ec75e60456487ca3c">&#9670;&nbsp;</a></span>getDirAng()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Double_t * getDirAng </td>
          <td>(</td>
          <td class="paramtype">Double_t&#160;</td>
          <td class="paramname"><em>x0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Double_t&#160;</td>
          <td class="paramname"><em>z0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Double_t&#160;</td>
          <td class="paramname"><em>x1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Double_t&#160;</td>
          <td class="paramname"><em>z1</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Takes in the value of Tx (x0,z0) and Rx (x1,z1) coordinates and calculates a guess for the launch angle of the Direct ray. </p>
<p class="">This function is just used to calculate launch angles for the Direct ray. There is a for loop which runs over all the possible values of the launch angle that can give a value closest to zero for the launch angle function. Please look at my raytracing_code.pdf presentation for more details about this function. If you want to understand how this function was derived look at Der_LauAng.pdf. </p>

<p class="definition">Definition at line <a class="el" href="RayTraceRK4_8C_source.html#l00947">947</a> of file <a class="el" href="RayTraceRK4_8C_source.html">RayTraceRK4.C</a>.</p>

<p class="reference">References <a class="el" href="RayTraceRK4_8C_source.html#l00020">A</a>, <a class="el" href="RayTraceRK4_8C_source.html#l00021">B</a>, <a class="el" href="RayTraceRK4_8C_source.html#l00022">C</a>, <a class="el" href="RayTraceRK4_8C_source.html#l00016">h</a>, <a class="el" href="RayTraceRK4_8C_source.html#l00892">n()</a>, and <a class="el" href="RayTraceRK4_8C_source.html#l00012">pi</a>.</p>

<p class="reference">Referenced by <a class="el" href="RayTraceRK4_8C_source.html#l01050">getStartAngles()</a>.</p>
<div class="fragment"><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;                                                                      {</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;  <span class="comment">// Double_t A=1.788;</span></div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;  <span class="comment">// Double_t B=-0.463;</span></div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;  <span class="comment">// Double_t C=0.014;//// no negative sign for negative depth</span></div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;  <span class="comment">// Double_t pi=4.0*atan(1.0);//// no negative sign for negative depth</span></div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;  </div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;  <span class="comment">// Double_t z0=0;</span></div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;  <span class="comment">// Double_t z1=-180;</span></div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;  Double_t n0=<a class="code" href="RayTraceRK4_8C.html#a7bee49b33affb6de35e7dd6787a7d1ff">A</a>+<a class="code" href="RayTraceRK4_8C.html#a3bff7602e1f23fa6422ebf501370116c">B</a>*exp(<a class="code" href="RayTraceRK4_8C.html#aef13ddd41f7e49a80e7475962eecfb19">C</a>*z0);</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;  Double_t <a class="code" href="RayTraceRK4_8C.html#a1702994504683249f957d9824faa03ea">n</a>=<a class="code" href="RayTraceRK4_8C.html#a7bee49b33affb6de35e7dd6787a7d1ff">A</a>+<a class="code" href="RayTraceRK4_8C.html#a3bff7602e1f23fa6422ebf501370116c">B</a>*exp(<a class="code" href="RayTraceRK4_8C.html#aef13ddd41f7e49a80e7475962eecfb19">C</a>*z1);</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;  <span class="comment">// Double_t x0=0;</span></div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;  <span class="comment">// Double_t x1=10;</span></div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;  Bool_t swapbool=(<a class="code" href="RayTraceRK4_8C.html#a1702994504683249f957d9824faa03ea">n</a>&lt;n0);</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;  <span class="keywordflow">if</span>(swapbool) {</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;    <span class="comment">//swap(n,n0);</span></div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;    <a class="code" href="RayTraceRK4_8C.html#a1702994504683249f957d9824faa03ea">n</a>=<a class="code" href="RayTraceRK4_8C.html#a7bee49b33affb6de35e7dd6787a7d1ff">A</a>+<a class="code" href="RayTraceRK4_8C.html#a3bff7602e1f23fa6422ebf501370116c">B</a>*exp(<a class="code" href="RayTraceRK4_8C.html#aef13ddd41f7e49a80e7475962eecfb19">C</a>*z0);</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;    n0=<a class="code" href="RayTraceRK4_8C.html#a7bee49b33affb6de35e7dd6787a7d1ff">A</a>+<a class="code" href="RayTraceRK4_8C.html#a3bff7602e1f23fa6422ebf501370116c">B</a>*exp(<a class="code" href="RayTraceRK4_8C.html#aef13ddd41f7e49a80e7475962eecfb19">C</a>*z1);</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;    cout&lt;&lt;<span class="stringliteral">&quot;SWAP&quot;</span>&lt;&lt;endl;</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;    <span class="comment">//std::cout&lt;&lt;&quot;swap!&quot;&lt;&lt;std::endl; // changed (so that z0 is always near surface?)</span></div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;  }</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;  </div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;  Double_t sDiff=<a class="code" href="RayTraceRK4_8C.html#aef13ddd41f7e49a80e7475962eecfb19">C</a>*fabs(x0-x1);</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160; </div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;  TF1 *fn=<span class="keyword">new</span> TF1(<span class="stringliteral">&quot;fn&quot;</span>,<span class="stringliteral">&quot;log((((sqrt([0]*[0]-sin(x)*sin(x)*[1]*[1])+sqrt([2]*[2]-sin(x)*sin(x)*[1]*[1]))/([0]-[2]))+([2]/sqrt([2]*[2]-sin(x)*sin(x)*[1]*[1])))/(((sqrt([1]*[1]-sin(x)*sin(x)*[1]*[1])+sqrt([2]*[2]-sin(x)*sin(x)*[1]*[1]))/([1]-[2]))+([2]/sqrt([2]*[2]-sin(x)*sin(x)*[1]*[1]))))-((sqrt([2]*[2]-sin(x)*sin(x)*[1]*[1])*[3])/(sin(x)*[1]))&quot;</span>,0,<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a>);</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;  fn-&gt;FixParameter(0,<a class="code" href="RayTraceRK4_8C.html#a1702994504683249f957d9824faa03ea">n</a>);</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;  fn-&gt;FixParameter(1,n0);</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;  fn-&gt;FixParameter(2,<a class="code" href="RayTraceRK4_8C.html#a7bee49b33affb6de35e7dd6787a7d1ff">A</a>);</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;  fn-&gt;FixParameter(3,sDiff);</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;  Double_t valarr1[20];</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;  Double_t valt1[20];</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;  Double_t valarr2[20];</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;  Double_t valt2[20];</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;  </div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;  Double_t <a class="code" href="RayTraceRK4_8C.html#aabbd1667d2631d1bf5e1302879450077">h</a>=0.00001;<span class="comment">//0.0000001;</span></div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;  Int_t N=floor(<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a>/<a class="code" href="RayTraceRK4_8C.html#aabbd1667d2631d1bf5e1302879450077">h</a>)+1;</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;  Double_t value;</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;  Double_t t=0.0;</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;  Int_t n1=0;</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;  Int_t n2=0;</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;  Bool_t n1bool=<span class="keyword">true</span>;</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;  Bool_t n2bool=<span class="keyword">true</span>;  </div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;  Double_t fnmax=-10000000;</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;  Double_t fnmaxloc=0;</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;  <span class="keywordflow">for</span>(Int_t i=0;i&lt;N;i++){</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;    value=fn-&gt;Eval(t);</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;    <span class="keywordflow">if</span>(t&gt;1 &amp;&amp; t&lt;2){</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;      <span class="keywordflow">if</span>(value&gt;fnmax){</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;    fnmax=value;</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;    fnmaxloc=t;</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;      }</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;    }</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;    t=t+<a class="code" href="RayTraceRK4_8C.html#aabbd1667d2631d1bf5e1302879450077">h</a>;   </div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;  }</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;  <span class="comment">// cout&lt;&lt;&quot;fnmax &quot;&lt;&lt;fnmax&lt;&lt;&quot; fnmaxloc &quot;&lt;&lt;fnmaxloc&lt;&lt;endl;</span></div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;  t=0;</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;  <span class="keywordflow">for</span>(Int_t i=0;i&lt;N;i++){</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;    value=fn-&gt;Eval(t);</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;    <span class="keywordflow">if</span>(value&lt;0.01 &amp;&amp; value&gt;-0.01 &amp;&amp; n1bool==<span class="keyword">true</span>){</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;      valarr1[n1]=fabs(value);</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;      valt1[n1]=t;</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;      <span class="comment">//  cout&lt;&lt;&quot;t &quot;&lt;&lt;t&lt;&lt;&quot; , value &quot;&lt;&lt;valarr1[n1]&lt;&lt;&quot; &quot;&lt;&lt;n1&lt;&lt;endl;</span></div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;      n1++;</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;      <span class="keywordflow">if</span>(n1==20)n1bool=<span class="keyword">false</span>;</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;    }</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;    </div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;    <span class="keywordflow">if</span>(value&lt;0.01 &amp;&amp; value&gt;-0.01 &amp;&amp; t&gt;fnmaxloc &amp;&amp; n2bool==<span class="keyword">true</span> ){</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;      valarr2[n2]=fabs(value);</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;      valt2[n2]=t;</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;      <span class="comment">//       cout&lt;&lt;&quot;t &quot;&lt;&lt;t&lt;&lt;&quot; , value &quot;&lt;&lt;valarr2[n2]&lt;&lt;&quot; &quot;&lt;&lt;n2&lt;&lt;endl;</span></div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;      n2++;</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;      <span class="keywordflow">if</span>(n2==20)n2bool=<span class="keyword">false</span>;</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;    }</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;    t=t+<a class="code" href="RayTraceRK4_8C.html#aabbd1667d2631d1bf5e1302879450077">h</a>;</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;  }</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;  </div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;  Double_t minel1=TMath::MinElement(n1,valarr1);</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;  Int_t locmin1=TMath::LocMin(n1,valarr1);</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;  Double_t minel2=TMath::MinElement(n2,valarr2);</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;  Int_t locmin2=TMath::LocMin(n2,valarr2);</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;  Double_t *th0p=<span class="keyword">new</span> Double_t[2];</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;  <span class="keywordflow">if</span>(n1&gt;0){</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;    th0p[0]=valt1[locmin1];</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;  } </div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;  <span class="keywordflow">if</span>(n1==0){</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;    th0p[0]=0;</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;  }</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;  <span class="keywordflow">if</span>(n2&gt;0){</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;    th0p[1]=valt2[locmin2];</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;  }</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;  <span class="keywordflow">if</span>(n2==0){</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;    th0p[1]=0;</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;  }</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;  <span class="comment">// cout&lt;&lt;&quot;z0 &quot;&lt;&lt;z0&lt;&lt;&quot; , x0 &quot;&lt;&lt;x0&lt;&lt;&quot;, z &quot;&lt;&lt;z1&lt;&lt;&quot; , x1 &quot;&lt;&lt;x1&lt;&lt;&quot; &quot;&lt;&lt;th0p[0]*(180/pi)&lt;&lt;&quot; &quot;&lt;&lt;th0p[1]*(180/pi)&lt;&lt;&quot; launch output&quot;&lt;&lt;endl;</span></div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;  <span class="keywordflow">return</span> th0p;</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;  </div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;}</div><div class="ttc" id="RayTraceRK4_8C_html_aef13ddd41f7e49a80e7475962eecfb19"><div class="ttname"><a href="RayTraceRK4_8C.html#aef13ddd41f7e49a80e7475962eecfb19">C</a></div><div class="ttdeci">const Double_t C</div><div class="ttdef"><b>Definition:</b> <a href="RayTraceRK4_8C_source.html#l00022">RayTraceRK4.C:22</a></div></div>
<div class="ttc" id="RayTraceRK4_8C_html_a7bee49b33affb6de35e7dd6787a7d1ff"><div class="ttname"><a href="RayTraceRK4_8C.html#a7bee49b33affb6de35e7dd6787a7d1ff">A</a></div><div class="ttdeci">const Double_t A</div><div class="ttdef"><b>Definition:</b> <a href="RayTraceRK4_8C_source.html#l00020">RayTraceRK4.C:20</a></div></div>
<div class="ttc" id="RayTraceRK4_8C_html_a615dac8ee3d3e28f8224aa4f3131c701"><div class="ttname"><a href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a></div><div class="ttdeci">const Double_t pi</div><div class="ttdef"><b>Definition:</b> <a href="RayTraceRK4_8C_source.html#l00012">RayTraceRK4.C:12</a></div></div>
<div class="ttc" id="RayTraceRK4_8C_html_a1702994504683249f957d9824faa03ea"><div class="ttname"><a href="RayTraceRK4_8C.html#a1702994504683249f957d9824faa03ea">n</a></div><div class="ttdeci">Double_t n(Double_t z)</div><div class="ttdoc">Takes in values of A,B &amp; C and the depth z and returns value for refrative index model n(z)...</div><div class="ttdef"><b>Definition:</b> <a href="RayTraceRK4_8C_source.html#l00892">RayTraceRK4.C:892</a></div></div>
<div class="ttc" id="RayTraceRK4_8C_html_aabbd1667d2631d1bf5e1302879450077"><div class="ttname"><a href="RayTraceRK4_8C.html#aabbd1667d2631d1bf5e1302879450077">h</a></div><div class="ttdeci">Double_t h</div><div class="ttdef"><b>Definition:</b> <a href="RayTraceRK4_8C_source.html#l00016">RayTraceRK4.C:16</a></div></div>
<div class="ttc" id="RayTraceRK4_8C_html_a3bff7602e1f23fa6422ebf501370116c"><div class="ttname"><a href="RayTraceRK4_8C.html#a3bff7602e1f23fa6422ebf501370116c">B</a></div><div class="ttdeci">const Double_t B</div><div class="ttdef"><b>Definition:</b> <a href="RayTraceRK4_8C_source.html#l00021">RayTraceRK4.C:21</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="RayTraceRK4_8C_ae5e3f9f446f6172ec75e60456487ca3c_cgraph.png" border="0" usemap="#RayTraceRK4_8C_ae5e3f9f446f6172ec75e60456487ca3c_cgraph" alt=""/></div>
<map name="RayTraceRK4_8C_ae5e3f9f446f6172ec75e60456487ca3c_cgraph" id="RayTraceRK4_8C_ae5e3f9f446f6172ec75e60456487ca3c_cgraph">
<area shape="rect" id="node2" href="RayTraceRK4_8C.html#a1702994504683249f957d9824faa03ea" title="Takes in values of A,B &amp; C and the depth z and returns value for refrative index model n(z)..." alt="" coords="133,5,172,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="RayTraceRK4_8C_ae5e3f9f446f6172ec75e60456487ca3c_icgraph.png" border="0" usemap="#RayTraceRK4_8C_ae5e3f9f446f6172ec75e60456487ca3c_icgraph" alt=""/></div>
<map name="RayTraceRK4_8C_ae5e3f9f446f6172ec75e60456487ca3c_icgraph" id="RayTraceRK4_8C_ae5e3f9f446f6172ec75e60456487ca3c_icgraph">
<area shape="rect" id="node2" href="RayTraceRK4_8C.html#adbd350e958beadff13a5460dc9368740" title="Takes in the value of Tx (x0,z0) and Rx (x1,z1) coordinates and calculates a guess for the start laun..." alt="" coords="133,5,241,32"/>
<area shape="rect" id="node3" href="RayTraceRK4_8C.html#ae524948803cf17eca25b0cd2ba17dc29" title="This is the main function where all the calculations are done using the RK4 method. This function takes in the values of: " alt="" coords="289,5,395,32"/>
</map>
</div>

</div>
</div>
<a id="adf18e16d4be5e4e421640012a3356a38"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adf18e16d4be5e4e421640012a3356a38">&#9670;&nbsp;</a></span>getReflAng()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Double_t getReflAng </td>
          <td>(</td>
          <td class="paramtype">Double_t&#160;</td>
          <td class="paramname"><em>x0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Double_t&#160;</td>
          <td class="paramname"><em>z0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Double_t&#160;</td>
          <td class="paramname"><em>x1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Double_t&#160;</td>
          <td class="paramname"><em>z1</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Takes in the value of Tx (x0,z0) and Rx (x1,z1) coordinates and calculates a guess for the launch angle of the Reflected or Refracted ray. </p>
<p class="">This function is used to calculate launch angles for the Reflected &amp; Refracted rays. For the refracted one I add 15 deg to the angle value it returns (implemented in <a class="el" href="RayTraceRK4_8C.html#adbd350e958beadff13a5460dc9368740" title="Takes in the value of Tx (x0,z0) and Rx (x1,z1) coordinates and calculates a guess for the start laun...">getStartAngles()</a> ). This is the primary method of calculating guess angles for the Reflected/Refracted rays if this fails I move on to the secondary method implemented in <a class="el" href="RayTraceRK4_8C.html#adbd350e958beadff13a5460dc9368740" title="Takes in the value of Tx (x0,z0) and Rx (x1,z1) coordinates and calculates a guess for the start laun...">getStartAngles()</a>. Please look at my raytracing_code.pdf presentation for more details about this function. </p>

<p class="definition">Definition at line <a class="el" href="RayTraceRK4_8C_source.html#l01179">1179</a> of file <a class="el" href="RayTraceRK4_8C_source.html">RayTraceRK4.C</a>.</p>

<p class="reference">References <a class="el" href="RayTraceRK4_8C_source.html#l00012">pi</a>.</p>

<p class="reference">Referenced by <a class="el" href="RayTraceRK4_8C_source.html#l01050">getStartAngles()</a>.</p>
<div class="fragment"><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;                                                                       {</div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;  <span class="comment">// Double_t x0=0;</span></div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;  <span class="comment">// Double_t x1=150;</span></div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;  <span class="comment">// Double_t z0=-150;</span></div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;  <span class="comment">// Double_t z1=-200;</span></div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;  Double_t fmin=fabs(z0);</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;  Double_t fmax=sqrt(z0*z0+(x0-x1)*(x0-x1));</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;  Double_t gmin=fabs(z1);</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;  Double_t gmax=sqrt(z1*z1+(x0-x1)*(x0-x1));</div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;  Double_t thf=<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a>/2-acos(fabs(x1-x0)/fmax);</div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;  Double_t thg=<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a>/2-acos(fabs(x1-x0)/gmax);</div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;</div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;  Double_t thl=0;</div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;  Double_t thh=0;</div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;  <span class="comment">//cout&lt;&lt;gmin&lt;&lt;&quot; &quot;&lt;&lt;gmax&lt;&lt;&quot; &quot;&lt;&lt;fmin&lt;&lt;&quot; &quot;&lt;&lt;fmax&lt;&lt;&quot; &quot;&lt;&lt;thl&lt;&lt;&quot; &quot;&lt;&lt;thh&lt;&lt;&quot; &quot;&lt;&lt;thg&lt;&lt;&quot; &quot;&lt;&lt;thf&lt;&lt;endl;</span></div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;  Bool_t con1=<span class="keyword">false</span>;</div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;    </div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;  Int_t num=500;</div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;  Int_t iplt=0;    </div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;  <span class="keywordflow">if</span>(thf&gt;thg){</div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;    thl=thg;</div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;    thh=thf;</div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;    con1=<span class="keyword">true</span>;</div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;  }</div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;  <span class="keywordflow">if</span>(thg&gt;thf &amp;&amp; con1==<span class="keyword">false</span>){</div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;    thl=thf;</div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;    thh=thg;</div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;  }</div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;  <span class="keywordflow">if</span>(thg==thf){</div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;    thl=thf;</div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;    thh=thg;</div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;  }</div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;</div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;  Double_t rtrnang=0;</div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;  </div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;  Double_t dummyg=0;</div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;  Double_t dummyf=0;</div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;  Double_t dummyth=0;</div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;  iplt=0;</div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;  <span class="keywordflow">for</span>(Int_t ign=0;ign&lt;num;ign++){</div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;    <span class="keywordflow">for</span>(Int_t ifn=0;ifn&lt;num;ifn++){</div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;      <span class="keywordflow">for</span>(Int_t itn=0;itn&lt;num;itn++){</div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;    dummyg=gmin+(fabs(gmin-gmax)/num)*ign;</div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;    dummyf=fmin+(fabs(fmin-fmax)/num)*ifn;</div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;    dummyth=thl+(fabs(thl-<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a>)/num)*itn;</div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;    </div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;    <span class="keywordflow">if</span>(dummyg&gt;gmin &amp;&amp; dummyg&lt;gmax &amp;&amp; dummyf&gt;fmin &amp;&amp; dummyf&lt;fmax &amp;&amp; dummyth&gt;thl &amp;&amp; dummyth&lt;<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a>){</div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;      <span class="keywordflow">if</span>(fabs(fabs(z0/dummyf)-fabs(z1/dummyg))&lt;0.01){</div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;        <span class="keywordflow">if</span>(fabs(pow(dummyg,2)+pow(dummyf,2)-2*dummyg*dummyf*cos(dummyth)-pow(sqrt(pow(x0-x1,2)+pow(z0-z1,2)),2))&lt;1 &amp;&amp; iplt==0){</div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;          <span class="comment">//cout&lt;&lt;ix&lt;&lt;&quot; &quot;&lt;&lt;iz&lt;&lt;&quot; &quot;&lt;&lt;ign&lt;&lt;&quot; &quot;&lt;&lt;dummyg&lt;&lt;&quot; &quot;&lt;&lt;ifn&lt;&lt;&quot; &quot;&lt;&lt;dummyf&lt;&lt;&quot; &quot;&lt;&lt;fabs(z0/dummyf)-fabs(z1/dummyg)&lt;&lt;&quot; &quot;&lt;&lt;thl*(180.0/pi)&lt;&lt;&quot; &quot;&lt;&lt;fabs(pow(dummyg,2)+pow(dummyf,2)-2*dummyg*dummyf*cos(dummyth)-pow(sqrt(pow(x0-x1,2)+pow(z0-z1,2)),2))&lt;&lt;endl;</span></div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;          rtrnang=(thl/2)-2.0*(<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a>/180.0);</div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;          iplt++;</div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;        }</div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;      }</div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;    }   </div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;      }</div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;    }</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;  }</div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;</div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;  <span class="keywordflow">return</span> rtrnang;</div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;}</div><div class="ttc" id="RayTraceRK4_8C_html_a615dac8ee3d3e28f8224aa4f3131c701"><div class="ttname"><a href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a></div><div class="ttdeci">const Double_t pi</div><div class="ttdef"><b>Definition:</b> <a href="RayTraceRK4_8C_source.html#l00012">RayTraceRK4.C:12</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="RayTraceRK4_8C_adf18e16d4be5e4e421640012a3356a38_icgraph.png" border="0" usemap="#RayTraceRK4_8C_adf18e16d4be5e4e421640012a3356a38_icgraph" alt=""/></div>
<map name="RayTraceRK4_8C_adf18e16d4be5e4e421640012a3356a38_icgraph" id="RayTraceRK4_8C_adf18e16d4be5e4e421640012a3356a38_icgraph">
<area shape="rect" id="node2" href="RayTraceRK4_8C.html#adbd350e958beadff13a5460dc9368740" title="Takes in the value of Tx (x0,z0) and Rx (x1,z1) coordinates and calculates a guess for the start laun..." alt="" coords="140,5,248,32"/>
<area shape="rect" id="node3" href="RayTraceRK4_8C.html#ae524948803cf17eca25b0cd2ba17dc29" title="This is the main function where all the calculations are done using the RK4 method. This function takes in the values of: " alt="" coords="296,5,401,32"/>
</map>
</div>

</div>
</div>
<a id="adbd350e958beadff13a5460dc9368740"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adbd350e958beadff13a5460dc9368740">&#9670;&nbsp;</a></span>getStartAngles()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Double_t * getStartAngles </td>
          <td>(</td>
          <td class="paramtype">Double_t&#160;</td>
          <td class="paramname"><em>x0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Double_t&#160;</td>
          <td class="paramname"><em>z0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Double_t&#160;</td>
          <td class="paramname"><em>x1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Double_t&#160;</td>
          <td class="paramname"><em>z1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Int_t&#160;</td>
          <td class="paramname"><em>solnum</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Takes in the value of Tx (x0,z0) and Rx (x1,z1) coordinates and calculates a guess for the start launch angle of whatever type of ray you are working with. </p>
<p class="">Int_t solnum can have values 0 (Direct rays), 1 (Reflected rays) and 2 (Refracted rays). For Direct rays it uses <a class="el" href="RayTraceRK4_8C.html#ae5e3f9f446f6172ec75e60456487ca3c" title="Takes in the value of Tx (x0,z0) and Rx (x1,z1) coordinates and calculates a guess for the launch ang...">getDirAng()</a> and for Reflected or Refracted rays it uses getReflAng. Then it corrects the launch angle a bit depending on what it gets from these functions. These corrections are just based on experience on how these functions work For Reflected rays if the primary method from <a class="el" href="RayTraceRK4_8C.html#adf18e16d4be5e4e421640012a3356a38" title="Takes in the value of Tx (x0,z0) and Rx (x1,z1) coordinates and calculates a guess for the launch ang...">getReflAng()</a> fails to give any result then it uses the secondary method already present in it. Please refer to raytracing_code.pdf for more details. </p>

<p class="definition">Definition at line <a class="el" href="RayTraceRK4_8C_source.html#l01050">1050</a> of file <a class="el" href="RayTraceRK4_8C_source.html">RayTraceRK4.C</a>.</p>

<p class="reference">References <a class="el" href="RayTraceRK4_8C_source.html#l00947">getDirAng()</a>, <a class="el" href="RayTraceRK4_8C_source.html#l01179">getReflAng()</a>, and <a class="el" href="RayTraceRK4_8C_source.html#l00012">pi</a>.</p>

<p class="reference">Referenced by <a class="el" href="RayTraceRK4_8C_source.html#l00183">RayTraceRK4()</a>.</p>
<div class="fragment"><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;                                                                                          {</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;  </div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;  Double_t midang=0;</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;  Double_t *outfir=<span class="keyword">new</span> Double_t[2];</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;  outfir[0]=0;</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;  outfir[1]=0;</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;  </div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;  <span class="keywordflow">if</span>(solnum==1 || solnum==2){</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;    midang=<a class="code" href="RayTraceRK4_8C.html#adf18e16d4be5e4e421640012a3356a38">getReflAng</a>(x0,z0,x1,z1);</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;    <span class="keywordflow">if</span>(solnum==2 &amp;&amp; midang!=0){</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;      midang=midang+15*(<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a>/180.0);</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;    }</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;    </div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;    <span class="keywordflow">if</span>(midang==0){</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;      midang=((<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a>/2)-atan(fabs((z0*2.0)/(x1-x0))));</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;      <span class="keywordflow">if</span>(midang&gt;49*(<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a>/180)){</div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;    midang=midang-15*(<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a>/180);</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;      }</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;      <span class="keywordflow">if</span>(midang&lt;50*(<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a>/180)){</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;    midang=midang-0.5*(<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a>/180);</div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;      } </div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;    }</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;    </div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;    outfir[0]=midang-2*(<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a>/180);</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;    outfir[1]=midang+2*(<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a>/180);</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;    </div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;    <span class="keywordflow">if</span>(outfir[0]&lt;0*(<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a>/180)){</div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;      midang=3*(<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a>/180);</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;      outfir[0]=midang-2*(<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a>/180);</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;      outfir[1]=midang+2*(<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a>/180);</div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;    }  </div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;    </div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;    <span class="keywordflow">if</span>(outfir[1]&gt;60*(<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a>/180) &amp;&amp; solnum==1){</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;      <span class="comment">//midang=3*(pi/180);</span></div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;      outfir[0]=outfir[0]-2*(<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a>/180);</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;      outfir[1]=outfir[1]-2*(<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a>/180);</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;    }  </div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;    </div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;  }  </div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;  </div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;  <span class="keywordflow">if</span>(solnum==0){</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;    </div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;    Double_t *ang2=<a class="code" href="RayTraceRK4_8C.html#ae5e3f9f446f6172ec75e60456487ca3c">getDirAng</a>(x0,z0,x1,z1);</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;    midang=ang2[1];</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;    </div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;    <span class="keywordflow">if</span>(z0&lt;z1){</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;      midang=ang2[0];</div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;    }</div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;    </div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;    <span class="keywordflow">if</span>(z1&gt;z0 &amp;&amp; midang&gt;90*(<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a>/180)){</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;      midang=<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a>-midang;</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;    }</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;    </div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;    outfir[0]=midang-2*(<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a>/180);</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;    outfir[1]=midang+2*(<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a>/180);</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;    </div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;    <span class="keywordflow">if</span>(fabs(z0-z1)&lt;0.15 || ang2[0]&lt;0.01 || ang2[1]&lt;0.01){</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;      midang=(<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a>/2)-atan(fabs((z1-z0)/x1));</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;      </div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;      <span class="keywordflow">if</span>(midang&gt;<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a>/2){</div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;    midang=(<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a>/2)-2*(<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a>/180);</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;      }</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;    </div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;      outfir[0]=midang-2*(<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a>/180);</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;      outfir[1]=midang+2*(<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a>/180);</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;      </div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;      <span class="keywordflow">if</span>(outfir[0]&lt;0*(<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a>/180)){</div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;    midang=3*(<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a>/180);</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;    outfir[0]=midang-2*(<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a>/180);</div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;    outfir[1]=midang+2*(<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a>/180);</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;      }</div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;      </div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;    }</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;    <span class="keyword">delete</span> ang2;</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;  }</div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;  </div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;  <span class="keywordflow">return</span> outfir;</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;}</div><div class="ttc" id="RayTraceRK4_8C_html_a615dac8ee3d3e28f8224aa4f3131c701"><div class="ttname"><a href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a></div><div class="ttdeci">const Double_t pi</div><div class="ttdef"><b>Definition:</b> <a href="RayTraceRK4_8C_source.html#l00012">RayTraceRK4.C:12</a></div></div>
<div class="ttc" id="RayTraceRK4_8C_html_adf18e16d4be5e4e421640012a3356a38"><div class="ttname"><a href="RayTraceRK4_8C.html#adf18e16d4be5e4e421640012a3356a38">getReflAng</a></div><div class="ttdeci">Double_t getReflAng(Double_t x0, Double_t z0, Double_t x1, Double_t z1)</div><div class="ttdoc">Takes in the value of Tx (x0,z0) and Rx (x1,z1) coordinates and calculates a guess for the launch ang...</div><div class="ttdef"><b>Definition:</b> <a href="RayTraceRK4_8C_source.html#l01179">RayTraceRK4.C:1179</a></div></div>
<div class="ttc" id="RayTraceRK4_8C_html_ae5e3f9f446f6172ec75e60456487ca3c"><div class="ttname"><a href="RayTraceRK4_8C.html#ae5e3f9f446f6172ec75e60456487ca3c">getDirAng</a></div><div class="ttdeci">Double_t * getDirAng(Double_t x0, Double_t z0, Double_t x1, Double_t z1)</div><div class="ttdoc">Takes in the value of Tx (x0,z0) and Rx (x1,z1) coordinates and calculates a guess for the launch ang...</div><div class="ttdef"><b>Definition:</b> <a href="RayTraceRK4_8C_source.html#l00947">RayTraceRK4.C:947</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="RayTraceRK4_8C_adbd350e958beadff13a5460dc9368740_cgraph.png" border="0" usemap="#RayTraceRK4_8C_adbd350e958beadff13a5460dc9368740_cgraph" alt=""/></div>
<map name="RayTraceRK4_8C_adbd350e958beadff13a5460dc9368740_cgraph" id="RayTraceRK4_8C_adbd350e958beadff13a5460dc9368740_cgraph">
<area shape="rect" id="node2" href="RayTraceRK4_8C.html#ae5e3f9f446f6172ec75e60456487ca3c" title="Takes in the value of Tx (x0,z0) and Rx (x1,z1) coordinates and calculates a guess for the launch ang..." alt="" coords="165,5,245,32"/>
<area shape="rect" id="node4" href="RayTraceRK4_8C.html#adf18e16d4be5e4e421640012a3356a38" title="Takes in the value of Tx (x0,z0) and Rx (x1,z1) coordinates and calculates a guess for the launch ang..." alt="" coords="161,56,248,83"/>
<area shape="rect" id="node3" href="RayTraceRK4_8C.html#a1702994504683249f957d9824faa03ea" title="Takes in values of A,B &amp; C and the depth z and returns value for refrative index model n(z)..." alt="" coords="296,5,335,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="RayTraceRK4_8C_adbd350e958beadff13a5460dc9368740_icgraph.png" border="0" usemap="#RayTraceRK4_8C_adbd350e958beadff13a5460dc9368740_icgraph" alt=""/></div>
<map name="RayTraceRK4_8C_adbd350e958beadff13a5460dc9368740_icgraph" id="RayTraceRK4_8C_adbd350e958beadff13a5460dc9368740_icgraph">
<area shape="rect" id="node2" href="RayTraceRK4_8C.html#ae524948803cf17eca25b0cd2ba17dc29" title="This is the main function where all the calculations are done using the RK4 method. This function takes in the values of: " alt="" coords="161,5,267,32"/>
</map>
</div>

</div>
</div>
<a id="ab8e36e593e5ce8626d334c72466dbac6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab8e36e593e5ce8626d334c72466dbac6">&#9670;&nbsp;</a></span>getAngleCorrections()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Double_t * getAngleCorrections </td>
          <td>(</td>
          <td class="paramtype">Int_t&#160;</td>
          <td class="paramname"><em>num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Int_t&#160;</td>
          <td class="paramname"><em>antco</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Int_t&#160;</td>
          <td class="paramname"><em>D56co</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Double_t&#160;</td>
          <td class="paramname"><em>test0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Double_t&#160;</td>
          <td class="paramname"><em>test1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Int_t&#160;</td>
          <td class="paramname"><em>psns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Int_t&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Int_t&#160;</td>
          <td class="paramname"><em>solnum</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Takes in the value of Tx (x0,z0) and Rx (x1,z1) coordinates and corrects/adjusts the launch angles based on the accuracy of the guess. </p>
<p class="">Int_t solnum can have values 0 (Direct rays), 1 (Reflected rays) and 2 (Refracted rays). For Direct rays it corrects for preventing them from hitting the surface or from the bottom of the scan region if they miss the target. For Reflected rays it corrects for if they do not hit the surface or miss the target and hit the bottom of the scan region. For Refracted rays it corrects for preventing them from hitting the surface or from the bottom of the scan region if they miss the target. Please refer to raytracing_code.pdf for more details. These corrections are just based on experience on how these functions work </p>

<p class="definition">Definition at line <a class="el" href="RayTraceRK4_8C_source.html#l01131">1131</a> of file <a class="el" href="RayTraceRK4_8C_source.html">RayTraceRK4.C</a>.</p>

<p class="reference">References <a class="el" href="RayTraceRK4_8C_source.html#l00012">pi</a>.</p>

<p class="reference">Referenced by <a class="el" href="RayTraceRK4_8C_source.html#l00183">RayTraceRK4()</a>.</p>
<div class="fragment"><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;                                                                                                                                    {</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;  </div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;  <span class="keywordflow">if</span>(psns&lt;0 &amp;&amp; in==1){</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;    test0=test0-fabs(test1-test0)*0.6;</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;    test1=test1-fabs(test1-test0)*0.6;</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;  }</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;  <span class="keywordflow">if</span>(psns&lt;0 &amp;&amp; in==2){</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;    test1=test1-fabs(test1-test0)*0.6;</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;  }</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;  </div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;  <span class="keywordflow">if</span>(psns&gt;0){</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;    <span class="keywordflow">if</span>(num&gt;8 &amp;&amp; fabs(antco-D56co)&lt;=200){</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;      test0=test0+0.1*(<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a>/180)*psns;</div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;      test1=test1+0.1*(<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a>/180)*psns;</div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;    }  </div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;    <span class="keywordflow">if</span>(num&lt;9 &amp;&amp; fabs(antco-D56co)&lt;=200){</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;      test0=test0+0.5*(<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a>/180)*psns;</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;      test1=test1+0.5*(<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a>/180)*psns;</div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;    }</div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;    <span class="keywordflow">if</span>(num&gt;8 &amp;&amp; fabs(antco-D56co)&gt;200){</div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;      test0=test0+1*(<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a>/180)*psns;</div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;      test1=test1+1*(<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a>/180)*psns;</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;    }</div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;    <span class="keywordflow">if</span>(num&lt;9 &amp;&amp; fabs(antco-D56co)&gt;200){</div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;      test0=test0+2*(<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a>/180)*psns;</div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;      test1=test1+2*(<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a>/180)*psns;</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;    }</div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;  }</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;  <span class="keywordflow">if</span>(psns&gt;0 &amp;&amp; solnum==2){</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;    <span class="keywordflow">if</span>(num&gt;8 &amp;&amp; fabs(antco-D56co)&lt;=200){</div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;      test0=test0+1*(<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a>/180)*psns;</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;      test1=test1+1*(<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a>/180)*psns;</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;    }</div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;    <span class="keywordflow">if</span>(num&lt;9 &amp;&amp; fabs(antco-D56co)&lt;=200){</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;      test0=test0+2*(<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a>/180)*psns;</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;      test1=test1+2*(<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a>/180)*psns;</div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;    }</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;  }</div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160; </div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;  Double_t *outfir2=<span class="keyword">new</span> Double_t[2];</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;  outfir2[0]=test0;</div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;  outfir2[1]=test1;</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;  <span class="keywordflow">return</span> outfir2;</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;}</div><div class="ttc" id="RayTraceRK4_8C_html_a615dac8ee3d3e28f8224aa4f3131c701"><div class="ttname"><a href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a></div><div class="ttdeci">const Double_t pi</div><div class="ttdef"><b>Definition:</b> <a href="RayTraceRK4_8C_source.html#l00012">RayTraceRK4.C:12</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="RayTraceRK4_8C_ab8e36e593e5ce8626d334c72466dbac6_icgraph.png" border="0" usemap="#RayTraceRK4_8C_ab8e36e593e5ce8626d334c72466dbac6_icgraph" alt=""/></div>
<map name="RayTraceRK4_8C_ab8e36e593e5ce8626d334c72466dbac6_icgraph" id="RayTraceRK4_8C_ab8e36e593e5ce8626d334c72466dbac6_icgraph">
<area shape="rect" id="node2" href="RayTraceRK4_8C.html#ae524948803cf17eca25b0cd2ba17dc29" title="This is the main function where all the calculations are done using the RK4 method. This function takes in the values of: " alt="" coords="193,5,299,32"/>
</map>
</div>

</div>
</div>
<a id="ae524948803cf17eca25b0cd2ba17dc29"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae524948803cf17eca25b0cd2ba17dc29">&#9670;&nbsp;</a></span>RayTraceRK4()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Double_t* RayTraceRK4 </td>
          <td>(</td>
          <td class="paramtype">Double_t&#160;</td>
          <td class="paramname"><em>c1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Double_t&#160;</td>
          <td class="paramname"><em>c2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Double_t&#160;</td>
          <td class="paramname"><em>c3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Double_t&#160;</td>
          <td class="paramname"><em>r1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Double_t&#160;</td>
          <td class="paramname"><em>r2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Double_t&#160;</td>
          <td class="paramname"><em>r3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Int_t&#160;</td>
          <td class="paramname"><em>wsol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Double_t *&#160;</td>
          <td class="paramname"><em>frequency</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Int_t&#160;</td>
          <td class="paramname"><em>tausize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This is the main function where all the calculations are done using the RK4 method. This function takes in the values of: </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">c1</td><td>x position of transmitter </td></tr>
    <tr><td class="paramname">c2</td><td>y position of transmitter </td></tr>
    <tr><td class="paramname">c3</td><td>x position of transmitter </td></tr>
    <tr><td class="paramname">r1</td><td>y position of reciever </td></tr>
    <tr><td class="paramname">r2</td><td>x position of reciever </td></tr>
    <tr><td class="paramname">r3</td><td>y position of reciever </td></tr>
    <tr><td class="paramname">wsol</td><td>is basically what solution you want. </td></tr>
    <tr><td class="paramname">frequency</td><td>pointer to the array of frequencies in the signal that will be used to calculate attenuation of the signal </td></tr>
    <tr><td class="paramname">tausize</td><td>size of the pointer</td></tr>
  </table>
  </dd>
</dl>
<p>Find Direct Solutions,wsol==0</p>
<p class="">Find Reflected Solutions, wsol==1</p>
<p class="">Find Refracted Solutions, wsol==2</p>
<p class="">Find Direct &amp; Reflected Solutions, wsol==3</p>
<p class="">Find Refracted &amp; Reflected Solutions, wsol==4</p>
<p class="">Find Direct,Refracted &amp; Reflected Solutions, wsol==5</p>
<p class="">NOTE: Please look at testcode.C to see exactly how to use <a class="el" href="RayTraceRK4_8C.html#ae524948803cf17eca25b0cd2ba17dc29" title="This is the main function where all the calculations are done using the RK4 method. This function takes in the values of: ">RayTraceRK4()</a> function.</p>
<p class="">It takes in these parameter values and calculates the ray path and then returns The code returns you back a pointer to an array which you can use to get the Launch, Recieve and time (in seconds) of the ray. For example:</p>
<p class="">Double_t *getres=MRootScript_v2(800,0,-400,1000,0,-200,5);</p>
<p class="">getres[0]-&gt; Launch angle of direct ray in deg</p>
<p class="">getres[1]-&gt; Recieve angle of direct ray in deg</p>
<p class="">getres[2]-&gt; Time of direct ray in seconds</p>
<p class="">getres[3]-&gt; Launch angle of reflected ray in deg</p>
<p class="">getres[4]-&gt; Recieve angle of reflected ray in deg</p>
<p class="">getres[5]-&gt; Time of reflected ray in seconds</p>
<p class="">getres[6]-&gt; Launch angle of refracted ray in deg</p>
<p class="">getres[7]-&gt; Recieve angle of refracted ray in deg</p>
<p class="">getres[8]-&gt; Time of refracted ray in seconds</p>
<p class="">getres[9+tausize-1]-&gt; Fraction of Amplitde left after attenuation at the frequency values specified in the array of tauszie length for Direct Rays</p>
<p class="">getres[tausize+tausize*2-1]-&gt; Fraction of Amplitde left after attenuation at the frequency values specified in the array of tauszie length for Reflected Rays</p>
<p class="">getres[tausize*2+tausize*3-1]-&gt; Fraction of Amplitde left after attenuation at the frequency values specified in the array of tauszie length for Refracted Rays</p>
<p class="">If the code does not find a solution then:</p>
<p class="">getres[1]=-1; and/or getres[4]=-1; and/or getres[7]=-1;</p>
<p class="">The function prints out the new launch angles in each iteration as it is zoning in on the target.</p>
<p class="">Have a look at /docs/html/RayTraceRK4_8C.html to understand the code structure better.</p>
<p class="">I would like to add that my code is a bit slow and I have not really optimised it to be fast yet so if you guys come up with any ideas let me know,</p>
<p class="">Please read raytracing_code.pdf for more detail. If you find any weird behaviour or any issues please let me know.</p>
<p class="">If you want to know how I derived the function to calculate launch angle read Der_LauAng.pdf .</p>
<p class="">The temperature model has been taken from AraSim which also took it from here <a href="http://icecube.wisc.edu/~mnewcomb/radio/atten/">http://icecube.wisc.edu/~mnewcomb/radio/atten/</a> . This is basically Matt Newcomb's icecube directory which has alot of information, plots and codes about South Pole Ice activities. Please read it if you find it interesting. <a href="http://icecube.wisc.edu/~mnewcomb/radio/#iceabsorbtion">http://icecube.wisc.edu/~mnewcomb/radio/#iceabsorbtion</a> </p>

<p class="definition">Definition at line <a class="el" href="RayTraceRK4_8C_source.html#l00183">183</a> of file <a class="el" href="RayTraceRK4_8C_source.html">RayTraceRK4.C</a>.</p>

<p class="reference">References <a class="el" href="RayTraceRK4_8C_source.html#l00936">ftau()</a>, <a class="el" href="RayTraceRK4_8C_source.html#l00908">ftheta()</a>, <a class="el" href="RayTraceRK4_8C_source.html#l00942">ftime()</a>, <a class="el" href="RayTraceRK4_8C_source.html#l00900">fx()</a>, <a class="el" href="RayTraceRK4_8C_source.html#l00904">fz()</a>, <a class="el" href="RayTraceRK4_8C_source.html#l01131">getAngleCorrections()</a>, <a class="el" href="RayTraceRK4_8C_source.html#l01050">getStartAngles()</a>, <a class="el" href="RayTraceRK4_8C_source.html#l00016">h</a>, <a class="el" href="RayTraceRK4_8C_source.html#l00012">pi</a>, and <a class="el" href="RayTraceRK4_8C_source.html#l00018">tmax</a>.</p>
<div class="fragment"><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;                                                                                                                                             {</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  <span class="keyword">const</span> Int_t ntausize=tausize;</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  Double_t *output=<span class="keyword">new</span> Double_t[9+ntausize*3];</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  </div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  Double_t D56cor[3]={c1,c2,c3};<span class="comment">//Tx positions</span></div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  Double_t antcor[3]={r1,r2,r3};<span class="comment">//Rx Positions</span></div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  </div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  <span class="comment">// Int_t wsol=3;</span></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  <span class="comment">// string outFilename1=&quot;test.root&quot;;</span></div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  <span class="comment">// Double_t D56cor[3]{800,0,-300};//Tx positions</span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  <span class="comment">// Double_t antcor[3]={1000,0,-200};//Rx Positions</span></div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  Double_t lowerz=0;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  <span class="keywordflow">if</span>(antcor[2]&lt;D56cor[2]){</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    lowerz=antcor[2];</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  }</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  <span class="keywordflow">if</span>(antcor[2]&gt;D56cor[2]){</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    lowerz=D56cor[2];</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  }</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  <span class="keywordflow">if</span>(antcor[2]==D56cor[2]){</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    lowerz=D56cor[2];</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  }</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  lowerz=lowerz-200;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  <span class="comment">//Set the limits for the for-loop to what solutions you are looking for</span></div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  Int_t isol_strt=0;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  Int_t isol_stop=1;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  <span class="comment">//Find Direct Solutions</span></div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  <span class="keywordflow">if</span>(wsol==0){</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    isol_strt=0;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    isol_stop=1;</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  }</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  <span class="comment">//Find Reflected Solutions</span></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  <span class="keywordflow">if</span>(wsol==1){</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    isol_strt=1;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    isol_stop=2;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  }</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  <span class="comment">//Find Refracted Solutions</span></div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  <span class="keywordflow">if</span>(wsol==2){</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    isol_strt=2;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    isol_stop=3;</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  }</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  </div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  <span class="comment">//Find Direct &amp; Reflected Solutions</span></div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  <span class="keywordflow">if</span>(wsol==3){</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    isol_strt=0;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    isol_stop=2;</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  }</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;   <span class="comment">//Find Refracted &amp; Reflected Solutions</span></div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  <span class="keywordflow">if</span>(wsol==4){</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    isol_strt=1;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    isol_stop=3;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  }</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  <span class="comment">//Find Direct,Refracted &amp; Reflected Solutions</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  <span class="keywordflow">if</span>(wsol==5){</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    isol_strt=0;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    isol_stop=3;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  }</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  </div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  <span class="comment">//const char *outFilename = outFilename1.c_str();</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  <span class="comment">//TFile *newfile = new TFile(outFilename,&quot;recreate&quot;);</span></div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  </div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  <span class="comment">//Make variables for storing in a TTree. This will go into the file that the user creates</span></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  <span class="keyword">const</span>  Int_t nxyzout=3;</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  <span class="keyword">const</span>  Int_t nxzout=2;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  Int_t ntau;</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  Int_t nxyz;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  Int_t nxz;</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;  Int_t ndhitbr;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  Int_t ovrallbr;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  Int_t isolbr;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;  Double_t rTx[nxyzout];            </div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  Double_t rRx[nxyzout];</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  Double_t xzTx[nxzout];               </div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  Double_t xzRx[nxzout];</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  Double_t TransitTime;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;  Double_t AttFac[ntausize];</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  Double_t L_ang;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  Double_t R_ang;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  Double_t I_ang;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  Double_t I_cor[nxzout];</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  Bool_t WasSurfaceHit;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  <span class="comment">//Set branches for the TTree</span></div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  TTree *chTreeR = <span class="keyword">new</span> TTree(<span class="stringliteral">&quot;chTreeR&quot;</span>,<span class="stringliteral">&quot;Raytrace Sol. Info. tree&quot;</span>);</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  chTreeR-&gt;Branch(<span class="stringliteral">&quot;nxyz&quot;</span>,&amp;nxyz,<span class="stringliteral">&quot;nxyz/I&quot;</span>);</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  chTreeR-&gt;Branch(<span class="stringliteral">&quot;nxz&quot;</span>,&amp;nxz,<span class="stringliteral">&quot;nxz/I&quot;</span>);</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  chTreeR-&gt;Branch(<span class="stringliteral">&quot;ndhitbr&quot;</span>,&amp;ndhitbr,<span class="stringliteral">&quot;ndhitbr/I&quot;</span>);</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  chTreeR-&gt;Branch(<span class="stringliteral">&quot;ntau&quot;</span>,&amp;ntau,<span class="stringliteral">&quot;ntau/I&quot;</span>);</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  chTreeR-&gt;Branch(<span class="stringliteral">&quot;ovrallbr&quot;</span>,&amp;ovrallbr,<span class="stringliteral">&quot;ovrallbr/I&quot;</span>);  </div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  chTreeR-&gt;Branch(<span class="stringliteral">&quot;isolbr&quot;</span>,&amp;isolbr,<span class="stringliteral">&quot;isolbr/I&quot;</span>);  </div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  chTreeR-&gt;Branch(<span class="stringliteral">&quot;rTx&quot;</span>,rTx,<span class="stringliteral">&quot;rTx[nxyz]/D&quot;</span>);</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  chTreeR-&gt;Branch(<span class="stringliteral">&quot;rRx&quot;</span>,rRx,<span class="stringliteral">&quot;rRx[nxyz]/D&quot;</span>);</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  chTreeR-&gt;Branch(<span class="stringliteral">&quot;xzTx&quot;</span>,xzTx,<span class="stringliteral">&quot;xzTx[nxz]/D&quot;</span>);</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  chTreeR-&gt;Branch(<span class="stringliteral">&quot;xzRx&quot;</span>,xzRx,<span class="stringliteral">&quot;xzRx[nxz]/D&quot;</span>);</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  chTreeR-&gt;Branch(<span class="stringliteral">&quot;AttFac&quot;</span>,AttFac,<span class="stringliteral">&quot;AttFac[ntau]/D&quot;</span>);</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  chTreeR-&gt;Branch(<span class="stringliteral">&quot;TransitTime&quot;</span>,&amp;TransitTime,<span class="stringliteral">&quot;TransitTime/D&quot;</span>);</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  chTreeR-&gt;Branch(<span class="stringliteral">&quot;L_ang&quot;</span>,&amp;L_ang,<span class="stringliteral">&quot;L_ang/D&quot;</span>);</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  chTreeR-&gt;Branch(<span class="stringliteral">&quot;R_ang&quot;</span>,&amp;R_ang,<span class="stringliteral">&quot;R_ang/D&quot;</span>);</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  chTreeR-&gt;Branch(<span class="stringliteral">&quot;I_ang&quot;</span>,&amp;I_ang,<span class="stringliteral">&quot;I_ang/D&quot;</span>);</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  chTreeR-&gt;Branch(<span class="stringliteral">&quot;I_cor&quot;</span>,I_cor,<span class="stringliteral">&quot;I_cor[nxz]/D&quot;</span>);</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  chTreeR-&gt;Branch(<span class="stringliteral">&quot;WasSurfaceHit&quot;</span>,&amp;WasSurfaceHit,<span class="stringliteral">&quot;WasSurfaceHit/B&quot;</span>);</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  <span class="comment">//Set the RK4 varaibles and total steps for the while-loop (N_tot)</span></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  <span class="keyword">const</span> Int_t N_tot=floor(<a class="code" href="RayTraceRK4_8C.html#a01087fe32e34ceaff1dcd8a4a1bafb5e">tmax</a>/<a class="code" href="RayTraceRK4_8C.html#aabbd1667d2631d1bf5e1302879450077">h</a>);</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  </div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  Double_t K1_x;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  Double_t K2_x;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  Double_t K3_x;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  Double_t K4_x;</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;  </div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;  Double_t K1_z;</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  Double_t K2_z;</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;  Double_t K3_z;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  Double_t K4_z;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  Double_t K1_theta;</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;  Double_t K2_theta;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  Double_t K3_theta;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  Double_t K4_theta;</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;  Double_t K1_tau[ntausize];</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  Double_t K2_tau[ntausize];</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  Double_t K3_tau[ntausize];</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  Double_t K4_tau[ntausize];</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  </div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  Double_t K1_time;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  Double_t K2_time;</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  Double_t K3_time;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  Double_t K4_time;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  Double_t Coef=1.0/6.0;</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;  <span class="comment">//Set variables for the while loop</span></div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;  Int_t i=0.0;</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  Int_t brloop=0.0;</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  Int_t wloop=0.0;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  Int_t chkn=0.0;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  Double_t s=0.0;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  Double_t x0,y0;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;  Double_t x0d,y0d,z0d;</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;  Double_t z0=0.0;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;  Double_t x1=0;</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  Double_t z1=0;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;  Double_t *ang=0;</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;  Double_t th0=0;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  Double_t dist=0;</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;  Double_t time0=0.0;</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;  Double_t th0i=0.0;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  </div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  Double_t minz=0.0;</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;  Double_t minx=0.0;</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;  Double_t minth=0.0;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;  Double_t mintau[ntausize];</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;  Double_t tau0[ntausize];</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;  <span class="keywordflow">for</span>(Int_t itau=0;itau&lt;tausize;itau++){</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    mintau[itau]=0.0;</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    tau0[itau]=1.0;</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;  }</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;  Double_t mintime=0.0;</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;  Double_t mindist=0.0;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  Double_t prdist=0.0;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;  Bool_t dhit=<span class="keyword">true</span>;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  Double_t testfir[2]={3*(<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a>/180),7*(<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a>/180)};</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;  Double_t dz[2]={0.0,0.0};</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;  Double_t midang=0;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  Int_t ndhit=0;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;  Int_t ovrall=0;</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;  Double_t iniz=0;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;  Int_t solexist=0;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;  Bool_t surfhit=<span class="keyword">false</span>;</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;  Bool_t depthpass[2]={<span class="keyword">false</span>,<span class="keyword">false</span>};</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;  <span class="comment">//The for loop where all the calculations are done for all the solutions</span></div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;  <span class="keywordflow">for</span>(Int_t isol=isol_strt;isol&lt;isol_stop;isol++){</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <span class="keywordflow">if</span>(isol==0){</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;      cout&lt;&lt;<span class="stringliteral">&quot;~~~~~~~~~~~~~~~~~Finding DIRECT solutions~~~~~~~~~~~~~~~~~~&quot;</span>&lt;&lt;endl;</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    }</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    <span class="keywordflow">if</span>(isol==1){</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;      cout&lt;&lt;<span class="stringliteral">&quot;~~~~~~~~~~~~~~~~~Finding REFLECTED solutions~~~~~~~~~~~~~~~&quot;</span>&lt;&lt;endl;</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    }</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <span class="keywordflow">if</span>(isol==2){</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;      cout&lt;&lt;<span class="stringliteral">&quot;~~~~~~~~~~~~~~~~~Finding REFRACTED solutions~~~~~~~~~~~~~~~&quot;</span>&lt;&lt;endl;</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    }</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    dhit=<span class="keyword">true</span>;</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    ndhit=0;</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    ovrall=0;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    i=0;</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    solexist=0;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <span class="keywordflow">while</span>(dhit==<span class="keyword">true</span>){</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;      <span class="keywordflow">if</span>(i&gt;1){</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;      i=0.0;</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;      }</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;      wloop=0;</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;      brloop=0.0;</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;      s=0.0;</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;      x0=D56cor[0];</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;      y0=D56cor[1];</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;      z0=D56cor[2];</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;      x0d=antcor[0];</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;      y0d=antcor[1];</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;      z0d=antcor[2];</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;      iniz=z0;</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;      x1=sqrt(pow((x0d-x0),2)+pow((y0d-y0),2));</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;      dist=x1;</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;      z1=z0d;</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;      x0=0;</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;      <span class="keywordflow">if</span>(ndhit==0 &amp;&amp; i==0){</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    Double_t *infir=<a class="code" href="RayTraceRK4_8C.html#adbd350e958beadff13a5460dc9368740">getStartAngles</a>(x0,z0,x1,z1,isol);</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    testfir[0]=infir[0];</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    testfir[1]=infir[1];</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    cout&lt;&lt;<span class="stringliteral">&quot;START angles &quot;</span>&lt;&lt;testfir[0]*(180/<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a>)&lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt;testfir[1]*(180/<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a>)&lt;&lt;endl;</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;      }</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;      </div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;      th0i=testfir[i];</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;      th0=th0i;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;     </div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;      cout&lt;&lt;<span class="stringliteral">&quot;START: x0 &quot;</span>&lt;&lt;x0&lt;&lt;<span class="stringliteral">&quot; ,z0 &quot;</span>&lt;&lt;z0&lt;&lt;<span class="stringliteral">&quot; ,x1 &quot;</span>&lt;&lt;x1&lt;&lt;<span class="stringliteral">&quot; ,z1 &quot;</span>&lt;&lt;z1&lt;&lt;<span class="stringliteral">&quot; ,th0 &quot;</span>&lt;&lt;th0*(180/<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a>)&lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt;i&lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt;ndhit&lt;&lt;endl;</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;      <span class="keywordflow">for</span>(Int_t itau=0;itau&lt;tausize;itau++){</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    tau0[itau]=1.0;</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    mintau[itau]=0.0;</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;      }</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;      time0=0.0;</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;      minz=1000.0;</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;      minx=1000.0;</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;      minth=0.0;</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;      mintime=0.0;</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;      mindist=0.0;</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;      prdist=1;</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;      chkn=0;</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;      surfhit=<span class="keyword">false</span>;</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;      I_ang=0;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;      I_cor[0]=0;</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;      I_cor[1]=0;</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;      depthpass[i]=<span class="keyword">false</span>;</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;      <span class="comment">//RK4 while loop</span></div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;      <span class="keywordflow">while</span>(wloop&lt;N_tot){    </div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    </div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    K1_x=<a class="code" href="RayTraceRK4_8C.html#aabbd1667d2631d1bf5e1302879450077">h</a>*<a class="code" href="RayTraceRK4_8C.html#a4e7aa57933d95efc32019bfc6bffd863">fx</a>(th0);</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    K2_x=<a class="code" href="RayTraceRK4_8C.html#aabbd1667d2631d1bf5e1302879450077">h</a>*<a class="code" href="RayTraceRK4_8C.html#a4e7aa57933d95efc32019bfc6bffd863">fx</a>(th0+0.5*K1_x);</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    K3_x=<a class="code" href="RayTraceRK4_8C.html#aabbd1667d2631d1bf5e1302879450077">h</a>*<a class="code" href="RayTraceRK4_8C.html#a4e7aa57933d95efc32019bfc6bffd863">fx</a>(th0+0.5*K2_x);</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    K4_x=<a class="code" href="RayTraceRK4_8C.html#aabbd1667d2631d1bf5e1302879450077">h</a>*<a class="code" href="RayTraceRK4_8C.html#a4e7aa57933d95efc32019bfc6bffd863">fx</a>(th0+K3_x);</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    K1_z=<a class="code" href="RayTraceRK4_8C.html#aabbd1667d2631d1bf5e1302879450077">h</a>*<a class="code" href="RayTraceRK4_8C.html#a973febe1d212427d73db10966b273af4">fz</a>(th0);</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    K2_z=<a class="code" href="RayTraceRK4_8C.html#aabbd1667d2631d1bf5e1302879450077">h</a>*<a class="code" href="RayTraceRK4_8C.html#a973febe1d212427d73db10966b273af4">fz</a>(th0+0.5*K1_z);</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    K3_z=<a class="code" href="RayTraceRK4_8C.html#aabbd1667d2631d1bf5e1302879450077">h</a>*<a class="code" href="RayTraceRK4_8C.html#a973febe1d212427d73db10966b273af4">fz</a>(th0+0.5*K2_z);</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    K4_z=<a class="code" href="RayTraceRK4_8C.html#aabbd1667d2631d1bf5e1302879450077">h</a>*<a class="code" href="RayTraceRK4_8C.html#a973febe1d212427d73db10966b273af4">fz</a>(th0+K3_z);</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    K1_theta=<a class="code" href="RayTraceRK4_8C.html#aabbd1667d2631d1bf5e1302879450077">h</a>*<a class="code" href="RayTraceRK4_8C.html#abc2aaf8313c24c602356e10d240d82ee">ftheta</a>(th0,              z0);</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    K2_theta=<a class="code" href="RayTraceRK4_8C.html#aabbd1667d2631d1bf5e1302879450077">h</a>*<a class="code" href="RayTraceRK4_8C.html#abc2aaf8313c24c602356e10d240d82ee">ftheta</a>(th0+0.5*K1_theta, z0+0.5*K1_theta);</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    K3_theta=<a class="code" href="RayTraceRK4_8C.html#aabbd1667d2631d1bf5e1302879450077">h</a>*<a class="code" href="RayTraceRK4_8C.html#abc2aaf8313c24c602356e10d240d82ee">ftheta</a>(th0+0.5*K2_theta, z0+0.5*K2_theta);</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    K4_theta=<a class="code" href="RayTraceRK4_8C.html#aabbd1667d2631d1bf5e1302879450077">h</a>*<a class="code" href="RayTraceRK4_8C.html#abc2aaf8313c24c602356e10d240d82ee">ftheta</a>(th0+K3_theta,     z0+K3_theta);</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <span class="keywordflow">for</span>(Int_t itau=0;itau&lt;tausize;itau++){</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;      K1_tau[itau]=<a class="code" href="RayTraceRK4_8C.html#aabbd1667d2631d1bf5e1302879450077">h</a>*<a class="code" href="RayTraceRK4_8C.html#a0b88e3189963924bcd9ec97027477b3d">ftau</a>(tau0[itau],                 z0,frequency[itau]);</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;      K2_tau[itau]=<a class="code" href="RayTraceRK4_8C.html#aabbd1667d2631d1bf5e1302879450077">h</a>*<a class="code" href="RayTraceRK4_8C.html#a0b88e3189963924bcd9ec97027477b3d">ftau</a>(tau0[itau]+0.5*K1_tau[itau],      z0+0.5*K1_tau[itau],frequency[itau]);</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;      K3_tau[itau]=<a class="code" href="RayTraceRK4_8C.html#aabbd1667d2631d1bf5e1302879450077">h</a>*<a class="code" href="RayTraceRK4_8C.html#a0b88e3189963924bcd9ec97027477b3d">ftau</a>(tau0[itau]+0.5*K2_tau[itau],      z0+0.5*K2_tau[itau],frequency[itau]);</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;      K4_tau[itau]=<a class="code" href="RayTraceRK4_8C.html#aabbd1667d2631d1bf5e1302879450077">h</a>*<a class="code" href="RayTraceRK4_8C.html#a0b88e3189963924bcd9ec97027477b3d">ftau</a>(tau0[itau]+K3_tau[itau],          z0+K3_tau[itau],frequency[itau]);</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    }</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    </div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    K1_time=<a class="code" href="RayTraceRK4_8C.html#aabbd1667d2631d1bf5e1302879450077">h</a>*<a class="code" href="RayTraceRK4_8C.html#a106442644474ea4220dbe0a18e159e86">ftime</a>(z0);</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    K2_time=<a class="code" href="RayTraceRK4_8C.html#aabbd1667d2631d1bf5e1302879450077">h</a>*<a class="code" href="RayTraceRK4_8C.html#a106442644474ea4220dbe0a18e159e86">ftime</a>(z0+0.5*K1_time);</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    K3_time=<a class="code" href="RayTraceRK4_8C.html#aabbd1667d2631d1bf5e1302879450077">h</a>*<a class="code" href="RayTraceRK4_8C.html#a106442644474ea4220dbe0a18e159e86">ftime</a>(z0+0.5*K2_time);</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    K4_time=<a class="code" href="RayTraceRK4_8C.html#aabbd1667d2631d1bf5e1302879450077">h</a>*<a class="code" href="RayTraceRK4_8C.html#a106442644474ea4220dbe0a18e159e86">ftime</a>(z0+K3_time);</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    x0=x0+Coef*(K1_x+2*(K2_x+K3_x)+K4_x);</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    z0=z0+Coef*(K1_z+2*(K2_z+K3_z)+K4_z);</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    th0=th0+Coef*(K1_theta+2*(K2_theta+K3_theta)+K4_theta);</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    <span class="keywordflow">for</span>(Int_t itau=0;itau&lt;tausize;itau++){</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;      tau0[itau]=tau0[itau]-Coef*(K1_tau[itau]+2*(K2_tau[itau]+K3_tau[itau])+K4_tau[itau]);</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    }</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    </div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    time0=time0+Coef*(K1_time+2*(K2_time+K3_time)+K4_time);</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    <span class="comment">//Store value of dz at closest apporoach</span></div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    <span class="keywordflow">if</span>(fabs(dist-x0)&lt;0.1){</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;      dz[i]=(z0-z1);</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;      <span class="comment">//cout&lt;&lt;&quot;value of dz is &quot;&lt;&lt;dz[i]&lt;&lt;&quot; &quot;&lt;&lt;i&lt;&lt;endl;</span></div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    }</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <span class="comment">//Store the coordinates when surface is hit</span></div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    <span class="keywordflow">if</span>(z0&gt;0.0){</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;      I_ang=th0*(180/<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a>);</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;      I_cor[0]=x0;</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;      I_cor[1]=z0;</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;      th0=(<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a>/2-th0)+<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a>/2;</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;      surfhit=<span class="keyword">true</span>;</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;      cout&lt;&lt;<span class="stringliteral">&quot;Surface Hit&quot;</span>&lt;&lt;endl;</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    }</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    <span class="comment">//Store all the required variables when the target is hit</span></div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <span class="keywordflow">if</span>(fabs(z0-z1)&lt;0.5 &amp;&amp; fabs(dist-x0)&lt;0.5){     </div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;      <span class="keywordflow">if</span>(fabs(dist-x0)&lt;0.1 &amp;&amp; fabs(z0-z1)&lt;0.1){</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;        <span class="keywordflow">if</span>(sqrt((z0-z1)*(z0-z1)+(dist-x0)*(dist-x0))&lt;prdist){</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;          prdist=sqrt((z0-z1)*(z0-z1)+(dist-x0)*(dist-x0));</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;          minx=x0;</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;          minz=z0;</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;          minth=th0;</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;          <span class="keywordflow">for</span>(Int_t itau=0;itau&lt;tausize;itau++){</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;        mintau[itau]=tau0[itau];</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;          }</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;          mintime=time0;</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;          mindist=dist;</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;        }</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;        chkn++;   </div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;      }  </div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    }</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;        </div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    <span class="keywordflow">if</span>(surfhit==<span class="keyword">true</span> &amp;&amp; (isol==0 || isol==2)){</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;      wloop=N_tot+1;</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;      brloop=1;</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;      cout&lt;&lt;<span class="stringliteral">&quot;Surface hit finishing loop&quot;</span>&lt;&lt;endl;</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    }</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    <span class="keywordflow">if</span>(surfhit==<span class="keyword">false</span> &amp;&amp; dist-x0&lt;0 &amp;&amp; isol==1){</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;      wloop=N_tot+1;</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;      brloop=1;</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;      cout&lt;&lt;<span class="stringliteral">&quot;Surface is not being hit&quot;</span>&lt;&lt;endl;</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    }</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    </div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    <span class="keywordflow">if</span>((dist-x0)&lt;-2){</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;      wloop=N_tot+1;</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;      brloop=0;</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;      cout&lt;&lt;<span class="stringliteral">&quot;Target has been passed!&quot;</span>&lt;&lt;endl;</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    }</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    <span class="keywordflow">if</span>((z0-(lowerz))&lt;-2){</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;      wloop=N_tot+1;</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;      brloop=1;</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;      cout&lt;&lt;<span class="stringliteral">&quot;Ray going straight down! Target has been missed!&quot;</span>&lt;&lt;endl;</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;      depthpass[i]=<span class="keyword">true</span>;</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;      </div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    }</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    <span class="keywordflow">if</span>(chkn&gt;0 &amp;&amp; dist-x0&lt;0){</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;      wloop=N_tot+1;</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;      brloop=1;</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;      cout&lt;&lt;<span class="stringliteral">&quot;Target hit multiple times&quot;</span>&lt;&lt;endl;</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    }</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    </div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    s=s+<a class="code" href="RayTraceRK4_8C.html#aabbd1667d2631d1bf5e1302879450077">h</a>;</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    wloop++;</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;      }<span class="comment">//while loop</span></div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;      <span class="comment">//After each iteration select new angles and decrease the width of the cone</span></div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;      <span class="keywordflow">if</span>(chkn==0 &amp;&amp; i==1 &amp;&amp; brloop==0){</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    </div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    Double_t zdiff=0;</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    Double_t newang=0;  </div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    Double_t tet0=testfir[0];</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    Double_t tet1=testfir[1];</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    <span class="keywordflow">if</span>(dz[1]&gt;dz[0]){</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;      zdiff=dz[1]-dz[0];</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;      cout&lt;&lt;<span class="stringliteral">&quot;dz1&gt;dz0&quot;</span>&lt;&lt;endl;</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;      newang=testfir[0]+(fabs(dz[0])/zdiff)*(testfir[1]-testfir[0]);</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    }</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    <span class="keywordflow">if</span>(dz[0]&gt;dz[1]){</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;      zdiff=dz[0]-dz[1];</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;      cout&lt;&lt;<span class="stringliteral">&quot;dz0&gt;dz1&quot;</span>&lt;&lt;endl;</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;      newang=testfir[1]+(fabs(dz[1])/zdiff)*(testfir[0]-testfir[1]);</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    }</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    </div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    <span class="comment">//cout&lt;&lt;&quot;newang is &quot;&lt;&lt;newang*(180.0/pi)&lt;&lt;&quot; &quot;&lt;&lt;dz[1]-dz[0]&lt;&lt;&quot; &quot;&lt;&lt;testfir[1]-testfir[0]&lt;&lt;endl;</span></div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    testfir[1]=newang+fabs(tet1-tet0)*0.3;</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    testfir[0]=newang-fabs(tet1-tet0)*0.3;</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    <span class="keywordflow">if</span>(dz[0]==0 &amp;&amp; dz[1]==0){</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;      newang=20*(<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a>/180);</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;      cout&lt;&lt;<span class="stringliteral">&quot;Both dz are zero!&quot;</span>&lt;&lt;endl;</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;      testfir[1]=newang+2*(<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a>/180);</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;      testfir[0]=newang-2*(<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a>/180);</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    }</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    <span class="keywordflow">if</span>(testfir[0]&lt;0){</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;      newang=2.5*(<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a>/180);</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;      <span class="keywordflow">if</span>(isol==2){</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;        newang=65.0*(<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a>/180);</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;      }</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;      testfir[1]=newang+fabs(tet1-tet0)*0.3;</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;      testfir[0]=newang-fabs(tet1-tet0)*0.3;</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    }</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    <span class="keywordflow">if</span>(newang&gt;(65*(<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a>/180)) &amp;&amp; (isol==1)){</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;      newang=5.0*(<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a>/180);</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;      testfir[1]=newang+fabs(tet1-tet0)*0.3;</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;      testfir[0]=newang-fabs(tet1-tet0)*0.3;</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    }</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    </div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    <span class="keywordflow">if</span>(newang&gt;<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a> &amp;&amp; (isol==1 || isol==2)){</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;      newang=50*(<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a>/180);</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;      testfir[1]=newang+fabs(tet1-tet0)*0.3;</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;      testfir[0]=newang-fabs(tet1-tet0)*0.3;</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    }</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    <span class="keywordflow">if</span>(newang&gt;<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a> &amp;&amp; isol==0){</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;      newang=100*(<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a>/180);</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;      testfir[1]=newang+fabs(tet1-tet0)*0.3;</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;      testfir[0]=newang-fabs(tet1-tet0)*0.3;</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    }</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    cout&lt;&lt;<span class="stringliteral">&quot;new angles &quot;</span>&lt;&lt;testfir[0]*(180/<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a>)&lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt;testfir[1]*(180/<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a>)&lt;&lt;endl;</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    <span class="keywordflow">if</span>(testfir[1]&gt;<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a> || testfir[0]&gt;<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a>){</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;      dhit=<span class="keyword">false</span>;</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;          cout&lt;&lt;<span class="stringliteral">&quot;NO solution. Angle got too large.&quot;</span>&lt;&lt;chkn&lt;&lt;endl;</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    }</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    </div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    <span class="keywordflow">if</span>(testfir[1]&lt;0.1*(<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a>/180) || testfir[0]&lt;0.1*(<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a>/180)){</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;      dhit=<span class="keyword">false</span>;</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;      cout&lt;&lt;<span class="stringliteral">&quot;NO solution. Angle got too small.&quot;</span>&lt;&lt;chkn&lt;&lt;endl;</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    }</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    </div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    <span class="keywordflow">if</span>(iniz==0){</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;      cout&lt;&lt;<span class="stringliteral">&quot;Source is right at the surfcace!!&quot;</span>&lt;&lt;endl;</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;      <span class="keywordflow">if</span>(testfir[0]&lt;<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a>/2){</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;        testfir[0]=(<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a>/2)+0.01*(<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a>/180);</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;      }</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;      <span class="keywordflow">if</span>(testfir[1]&lt;<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a>/2){</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;        testfir[1]=(<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a>/2)+2*(<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a>/180);</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;      }</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    }</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    </div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    dz[0]=0;</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    dz[1]=0;</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    </div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;      }</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;   </div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;      <span class="keywordflow">if</span>(chkn&gt;0 &amp;&amp; surfhit==<span class="keyword">false</span> &amp;&amp; isol==0){</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    dhit=<span class="keyword">false</span>;</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;      }</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;      <span class="keywordflow">if</span>(chkn&gt;0 &amp;&amp; surfhit==<span class="keyword">true</span> &amp;&amp; isol==1){</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    dhit=<span class="keyword">false</span>;</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;      }</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;      <span class="keywordflow">if</span>(chkn&gt;0 &amp;&amp; surfhit==<span class="keyword">false</span> &amp;&amp; isol==2){</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    dhit=<span class="keyword">false</span>;</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;      }      </div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;      </div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;      <span class="keywordflow">if</span>((ndhit&gt;34 || ovrall&gt;63) &amp;&amp; chkn==0){</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    dhit=<span class="keyword">false</span>;</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    cout&lt;&lt;<span class="stringliteral">&quot;NO solution &quot;</span>&lt;&lt;chkn&lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt;ndhit&lt;&lt;endl;</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;      }</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;      <span class="comment">//cout&lt;&lt;i&lt;&lt;&quot; ivalue &quot;&lt;&lt;endl;</span></div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;      i++;</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;      <span class="keywordflow">if</span>((surfhit==<span class="keyword">true</span>) &amp;&amp; (isol==0 || isol==2)){</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    Double_t *infir2=<a class="code" href="RayTraceRK4_8C.html#ab8e36e593e5ce8626d334c72466dbac6">getAngleCorrections</a>(ndhit,antcor[0],D56cor[0],testfir[0], testfir[1], +1,i,isol);</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    <span class="keywordflow">if</span>(surfhit==<span class="keyword">true</span>){</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;      cout&lt;&lt;<span class="stringliteral">&quot;changing angles. surface was hit &quot;</span>&lt;&lt;endl;</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    }</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    <span class="keywordflow">if</span>(i==1){</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;      i=0;</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;      testfir[0]=infir2[0];</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;      testfir[1]=infir2[1];</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;    }</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    <span class="keywordflow">if</span>(i==2){</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;      i=1;</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;      testfir[0]=infir2[0];</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;      testfir[1]=infir2[1];</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;    }</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    <span class="keywordflow">if</span>(ndhit&gt;1){</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;      ndhit--;</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    }</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;      }</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;      </div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;      <span class="keywordflow">if</span>((depthpass[0]==<span class="keyword">true</span> || depthpass[1]==<span class="keyword">true</span>) &amp;&amp; (isol==0 || isol==2)){</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    Double_t *infir2=<a class="code" href="RayTraceRK4_8C.html#ab8e36e593e5ce8626d334c72466dbac6">getAngleCorrections</a>(ndhit,antcor[0],D56cor[0],testfir[0], testfir[1], -1,i,isol);</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;        cout&lt;&lt;<span class="stringliteral">&quot;changing angles. bottom was hit.&quot;</span>&lt;&lt;endl;</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    <span class="keywordflow">if</span>(i==1){</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;      i=0;</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;      testfir[0]=infir2[0];</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;      testfir[1]=infir2[1];</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    }</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    <span class="keywordflow">if</span>(i==2){</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;      i=1;</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;      testfir[1]=infir2[1]; </div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;    }</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    <span class="keywordflow">if</span>(ndhit&gt;1){</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;      ndhit--;</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    }</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;      }</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;      </div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;      <span class="keywordflow">if</span>((depthpass[0]==<span class="keyword">true</span> || depthpass[1]==<span class="keyword">true</span>) &amp;&amp; (isol==1)){</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    Double_t *infir2=<a class="code" href="RayTraceRK4_8C.html#ab8e36e593e5ce8626d334c72466dbac6">getAngleCorrections</a>(ndhit,antcor[0],D56cor[0],testfir[0], testfir[1], +1,i,isol);</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;        cout&lt;&lt;<span class="stringliteral">&quot;changing angles. bottom was hit &quot;</span>&lt;&lt;endl;</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;    <span class="keywordflow">if</span>(i==1){</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;     i=0;</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;     testfir[0]=infir2[0];</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;     testfir[1]=infir2[1];</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    }</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    <span class="keywordflow">if</span>(i==2){</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;     i=1;</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;     testfir[0]=infir2[0];</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;     testfir[1]=infir2[1];</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    }</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    <span class="keywordflow">if</span>(ndhit&gt;1){</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;      ndhit--;</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    }</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;      }</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;      <span class="keywordflow">if</span>((surfhit==<span class="keyword">false</span>) &amp;&amp; (isol==1)){</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    Double_t *infir2=<a class="code" href="RayTraceRK4_8C.html#ab8e36e593e5ce8626d334c72466dbac6">getAngleCorrections</a>(ndhit,antcor[0],D56cor[0],testfir[0], testfir[1], -1,i,isol);</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;        cout&lt;&lt;<span class="stringliteral">&quot;changing angles. surface is NOT being hit.&quot;</span>&lt;&lt;endl;</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    <span class="keywordflow">if</span>(i==1){</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;     i=0;</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;     testfir[0]=infir2[0];</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;     testfir[1]=infir2[1];</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    }</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;    <span class="keywordflow">if</span>(i==2){</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;      i=1;</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;      testfir[1]=infir2[1];</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    }</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    <span class="keywordflow">if</span>(ndhit&gt;1){</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;      ndhit--;</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    }</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;      }</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;      </div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;      ndhit++;</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;      ovrall++;</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    }<span class="comment">//dhit loop</span></div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;    <span class="comment">//Now we are done with RK4. Store and print whatever solutions we got.</span></div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;    <span class="keywordflow">if</span>(chkn&gt;0 &amp;&amp; surfhit==<span class="keyword">false</span> &amp;&amp; (isol==0 || isol==2)){</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;      <span class="keywordflow">if</span>(isol==0){</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;      cout&lt;&lt;<span class="stringliteral">&quot;x0 &quot;</span>&lt;&lt;D56cor[0]&lt;&lt;<span class="stringliteral">&quot; ,z0 &quot;</span>&lt;&lt;iniz&lt;&lt;<span class="stringliteral">&quot; ,x1 &quot;</span>&lt;&lt;minx&lt;&lt;<span class="stringliteral">&quot; ,z1 &quot;</span>&lt;&lt;minz&lt;&lt;<span class="stringliteral">&quot; ,th0 (Recieved Angle) &quot;</span>&lt;&lt;minth*(180/<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a>)&lt;&lt;<span class="stringliteral">&quot; ,Lang &quot;</span>&lt;&lt;th0i*(180/<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a>)&lt;&lt;<span class="stringliteral">&quot; ,time0 &quot;</span>&lt;&lt;mintime&lt;&lt;<span class="stringliteral">&quot; ,tau0[4] &quot;</span>&lt;&lt;mintau[4]&lt;&lt;<span class="stringliteral">&quot; ,I_ang (Incident angle on suface) &quot;</span>&lt;&lt;I_ang&lt;&lt;<span class="stringliteral">&quot; ,(Incident angle coordinates) I_corx &quot;</span>&lt;&lt;I_cor[0]&lt;&lt;<span class="stringliteral">&quot; ,Icorz &quot;</span>&lt;&lt;I_cor[1]&lt;&lt;<span class="stringliteral">&quot; Direct HIT!!. Writing file. &quot;</span>&lt;&lt;ovrall&lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt;ndhit&lt;&lt;endl;</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;      }</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;      <span class="keywordflow">if</span>(isol==2){</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;      cout&lt;&lt;<span class="stringliteral">&quot;x0 &quot;</span>&lt;&lt;D56cor[0]&lt;&lt;<span class="stringliteral">&quot; ,z0 &quot;</span>&lt;&lt;iniz&lt;&lt;<span class="stringliteral">&quot; ,x1 &quot;</span>&lt;&lt;minx&lt;&lt;<span class="stringliteral">&quot; ,z1 &quot;</span>&lt;&lt;minz&lt;&lt;<span class="stringliteral">&quot; ,th0 (Recieved Angle) &quot;</span>&lt;&lt;minth*(180/<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a>)&lt;&lt;<span class="stringliteral">&quot; ,Lang &quot;</span>&lt;&lt;th0i*(180/<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a>)&lt;&lt;<span class="stringliteral">&quot; ,time0 &quot;</span>&lt;&lt;mintime&lt;&lt;<span class="stringliteral">&quot; ,tau0[4] &quot;</span>&lt;&lt;mintau[4]&lt;&lt;<span class="stringliteral">&quot; ,I_ang (Incident angle on suface) &quot;</span>&lt;&lt;I_ang&lt;&lt;<span class="stringliteral">&quot; ,(Incident angle coordinates) I_corx  &quot;</span>&lt;&lt;I_cor[0]&lt;&lt;<span class="stringliteral">&quot; ,Icorz &quot;</span>&lt;&lt;I_cor[1]&lt;&lt;<span class="stringliteral">&quot; Refracted HIT!!. Writing file. &quot;</span>&lt;&lt;ovrall&lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt;ndhit&lt;&lt;endl;</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;      }</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;      </div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;      cout&lt;&lt;((mindist-minx))&lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt;minz-z1&lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt;mindist&lt;&lt;<span class="stringliteral">&quot; hit room&quot;</span>&lt;&lt;endl;</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;      </div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;      nxyz=3;</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;      nxz=2;</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;      ntau=ntausize;</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;      ndhitbr=ndhit;</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;      ovrallbr=ovrall;</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;      isolbr=isol;</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;      </div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;      rTx[0]=D56cor[0];</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;      rTx[1]=D56cor[1];</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;      rRx[0]=antcor[0];</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;      rRx[1]=antcor[1];</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;      </div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;      xzTx[0]=D56cor[0];</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;      xzTx[1]=iniz;</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;      xzRx[0]=minx;</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;      xzRx[1]=minz;</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;      TransitTime=mintime;</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;      <span class="keywordflow">for</span>(Int_t itau=0;itau&lt;tausize;itau++){</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;    AttFac[itau]=mintau[itau];</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;      }</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;      L_ang=th0i*(180/<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a>);</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;      R_ang=minth*(180/<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a>);</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;      WasSurfaceHit=surfhit;</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;      <span class="keywordflow">if</span>(isol==0){</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;    output[0]=L_ang;</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;    output[1]=R_ang;</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;    output[2]=TransitTime;      </div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    <span class="keywordflow">for</span>(Int_t itau=0;itau&lt;tausize;itau++){</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;      output[itau+9]=mintau[itau];</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    }</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;      }</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;      </div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;      <span class="keywordflow">if</span>(isol==2){</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;    output[6]=L_ang;</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;    output[7]=R_ang;</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;    output[8]=TransitTime;      </div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    <span class="keywordflow">for</span>(Int_t itau=tausize*2;itau&lt;tausize*3;itau++){</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;      output[itau+9]=mintau[itau-tausize*2];</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;    }</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;      }</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;      chTreeR-&gt;Fill();</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;      solexist=1;</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;    }</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;    </div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;    <span class="keywordflow">if</span>(chkn&gt;0 &amp;&amp; surfhit==<span class="keyword">true</span> &amp;&amp; isol==1){</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;      cout&lt;&lt;<span class="stringliteral">&quot;x0 &quot;</span>&lt;&lt;D56cor[0]&lt;&lt;<span class="stringliteral">&quot; ,z0 &quot;</span>&lt;&lt;iniz&lt;&lt;<span class="stringliteral">&quot; ,x1 &quot;</span>&lt;&lt;minx&lt;&lt;<span class="stringliteral">&quot; ,z1 &quot;</span>&lt;&lt;minz&lt;&lt;<span class="stringliteral">&quot; ,th0 (Recieved Angle) &quot;</span>&lt;&lt;minth*(180/<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a>)&lt;&lt;<span class="stringliteral">&quot; ,Lang &quot;</span>&lt;&lt;th0i*(180/<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a>)&lt;&lt;<span class="stringliteral">&quot; ,time0 &quot;</span>&lt;&lt;mintime&lt;&lt;<span class="stringliteral">&quot; ,tau0[4] &quot;</span>&lt;&lt;mintau[4]&lt;&lt;<span class="stringliteral">&quot; ,I_ang (Incident angle on suface) &quot;</span>&lt;&lt;I_ang&lt;&lt;<span class="stringliteral">&quot; ,(Incident angle coordinates) I_corx  &quot;</span>&lt;&lt;I_cor[0]&lt;&lt;<span class="stringliteral">&quot; ,Icorz &quot;</span>&lt;&lt;I_cor[1]&lt;&lt;<span class="stringliteral">&quot; Reflected HIT!!. Writing file. &quot;</span>&lt;&lt;ovrall&lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt;ndhit&lt;&lt;endl;</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;      cout&lt;&lt;((mindist-minx))&lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt;minz-z1&lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt;mindist&lt;&lt;<span class="stringliteral">&quot; hit room&quot;</span>&lt;&lt;endl;</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;      </div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;      nxyz=3;</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;      nxz=2;</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;      ntau=ntausize;</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;      ndhitbr=ndhit;</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;      ovrallbr=ovrall;</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;      isolbr=isol;</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;      </div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;      rTx[0]=D56cor[0];</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;      rTx[1]=D56cor[1];</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;      rRx[0]=antcor[0];</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;      rRx[1]=antcor[1];</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;      </div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;      xzTx[0]=D56cor[0];</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;      xzTx[1]=iniz;</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;      xzRx[0]=minx;</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;      xzRx[1]=minz;</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;      TransitTime=mintime;</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;      <span class="keywordflow">for</span>(Int_t itau=0;itau&lt;tausize;itau++){</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;        AttFac[itau]=mintau[itau];</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;      }</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;      L_ang=th0i*(180/<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a>);</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;      R_ang=minth*(180/<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a>);</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;      WasSurfaceHit=surfhit;</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;      output[3]=L_ang;</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;      output[4]=R_ang;</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;      output[5]=TransitTime;      </div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;      <span class="keywordflow">for</span>(Int_t itau=tausize;itau&lt;tausize*2;itau++){</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;    output[itau+9]=mintau[itau-tausize];</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;      }</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;     </div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;      chTreeR-&gt;Fill();</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;      solexist=1;</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    }</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;    <span class="keywordflow">if</span>((ndhit&gt;34 || chkn==0 || ovrall&gt;63) &amp;&amp; solexist==0){</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;      cout&lt;&lt;<span class="stringliteral">&quot;NO solution. Writing file. &quot;</span>&lt;&lt;chkn&lt;&lt;endl;</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;      cout&lt;&lt;<span class="stringliteral">&quot;x0 &quot;</span>&lt;&lt;D56cor[0]&lt;&lt;<span class="stringliteral">&quot; ,z0 &quot;</span>&lt;&lt;iniz&lt;&lt;<span class="stringliteral">&quot; ,x1 &quot;</span>&lt;&lt;minx&lt;&lt;<span class="stringliteral">&quot; ,z1 &quot;</span>&lt;&lt;minz&lt;&lt;<span class="stringliteral">&quot; ,th0 &quot;</span>&lt;&lt;minth*(180/<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a>)&lt;&lt;<span class="stringliteral">&quot; ,Lang &quot;</span>&lt;&lt;th0i*(180/<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a>)&lt;&lt;<span class="stringliteral">&quot; ,time0 &quot;</span>&lt;&lt;mintime&lt;&lt;<span class="stringliteral">&quot; ,tau0[0] &quot;</span>&lt;&lt;mintau[0]&lt;&lt;<span class="stringliteral">&quot; ,I_ang &quot;</span>&lt;&lt;I_ang&lt;&lt;<span class="stringliteral">&quot; ,I_corx &quot;</span>&lt;&lt;I_cor[0]&lt;&lt;<span class="stringliteral">&quot; ,Icorz &quot;</span>&lt;&lt;I_cor[1]&lt;&lt;<span class="stringliteral">&quot; MISS!! &quot;</span>&lt;&lt;endl;</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;      cout&lt;&lt;((mindist-minx))&lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt;minz-z1&lt;&lt;<span class="stringliteral">&quot; &quot;</span>&lt;&lt;mindist&lt;&lt;<span class="stringliteral">&quot; hit room&quot;</span>&lt;&lt;endl;</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;      </div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;      nxyz=3;</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;      nxz=2;</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;      ntau=ntausize;</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;      ndhitbr=ndhit;</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;      ovrallbr=ovrall;</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;      isolbr=isol;</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;      </div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;      rTx[0]=D56cor[0];</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;      rTx[1]=D56cor[1];</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;      rRx[0]=antcor[0];</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;      rRx[1]=antcor[1];</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;      </div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;      xzTx[0]=D56cor[0];</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;      xzTx[1]=iniz;</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;      xzRx[0]=minx;</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;      xzRx[1]=minz;</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;      TransitTime=mintime;</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;      <span class="keywordflow">for</span>(Int_t itau=0;itau&lt;tausize;itau++){</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;    AttFac[itau]=mintau[itau];</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;      }</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;     </div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;      <span class="keywordflow">if</span>(isol==0){</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;    L_ang=th0i*(180/<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a>);</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;    R_ang=-1;</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;    WasSurfaceHit=surfhit;</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;      </div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;    output[0]=L_ang;</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;    output[1]=R_ang;;</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;    output[2]=TransitTime;</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;    <span class="keywordflow">for</span>(Int_t itau=0;itau&lt;tausize;itau++){</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;      output[itau+9]=0;</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;    }</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;      }</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;      <span class="keywordflow">if</span>(isol==1){</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;    L_ang=th0i*(180/<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a>);</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;    R_ang=-1;</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;    WasSurfaceHit=surfhit;</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;      </div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;    output[3]=L_ang;</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;    output[4]=R_ang;</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;    output[5]=TransitTime;  </div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;    <span class="keywordflow">for</span>(Int_t itau=tausize;itau&lt;tausize*2;itau++){</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;      output[itau+9]=0;</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;    }</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;      }</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;      <span class="keywordflow">if</span>(isol==2){</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    L_ang=th0i*(180/<a class="code" href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a>);</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;    R_ang=-1;</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;    WasSurfaceHit=surfhit;</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;      </div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;    output[6]=L_ang;</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;    output[7]=R_ang;</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;    output[8]=TransitTime;            </div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;    <span class="keywordflow">for</span>(Int_t itau=tausize*2;itau&lt;tausize*3;itau++){</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;      output[itau+9]=0;</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    }</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;      }</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;      </div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;      chTreeR-&gt;Fill();</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;    }</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;    </div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;  }<span class="comment">//isol loop</span></div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;  <span class="comment">// newfile-&gt;Write();</span></div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;  <span class="comment">// newfile-&gt;Close();</span></div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;  <span class="comment">//Return the output array pointer</span></div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;  <span class="keywordflow">return</span> output;</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;}</div><div class="ttc" id="RayTraceRK4_8C_html_a01087fe32e34ceaff1dcd8a4a1bafb5e"><div class="ttname"><a href="RayTraceRK4_8C.html#a01087fe32e34ceaff1dcd8a4a1bafb5e">tmax</a></div><div class="ttdeci">const Double_t tmax</div><div class="ttdef"><b>Definition:</b> <a href="RayTraceRK4_8C_source.html#l00018">RayTraceRK4.C:18</a></div></div>
<div class="ttc" id="RayTraceRK4_8C_html_a0b88e3189963924bcd9ec97027477b3d"><div class="ttname"><a href="RayTraceRK4_8C.html#a0b88e3189963924bcd9ec97027477b3d">ftau</a></div><div class="ttdeci">Double_t ftau(Double_t tau, Double_t z, Double_t freq)</div><div class="ttdoc">Takes in the value of depth z and the frequency (in Ghz) and calculates the derivative of amplitude T...</div><div class="ttdef"><b>Definition:</b> <a href="RayTraceRK4_8C_source.html#l00936">RayTraceRK4.C:936</a></div></div>
<div class="ttc" id="RayTraceRK4_8C_html_a4e7aa57933d95efc32019bfc6bffd863"><div class="ttname"><a href="RayTraceRK4_8C.html#a4e7aa57933d95efc32019bfc6bffd863">fx</a></div><div class="ttdeci">Double_t fx(Double_t theta)</div><div class="ttdoc">Takes in value of theta (angle w.r.t to the vertical) and calculates the derivative of x w...</div><div class="ttdef"><b>Definition:</b> <a href="RayTraceRK4_8C_source.html#l00900">RayTraceRK4.C:900</a></div></div>
<div class="ttc" id="RayTraceRK4_8C_html_adbd350e958beadff13a5460dc9368740"><div class="ttname"><a href="RayTraceRK4_8C.html#adbd350e958beadff13a5460dc9368740">getStartAngles</a></div><div class="ttdeci">Double_t * getStartAngles(Double_t x0, Double_t z0, Double_t x1, Double_t z1, Int_t solnum)</div><div class="ttdoc">Takes in the value of Tx (x0,z0) and Rx (x1,z1) coordinates and calculates a guess for the start laun...</div><div class="ttdef"><b>Definition:</b> <a href="RayTraceRK4_8C_source.html#l01050">RayTraceRK4.C:1050</a></div></div>
<div class="ttc" id="RayTraceRK4_8C_html_a615dac8ee3d3e28f8224aa4f3131c701"><div class="ttname"><a href="RayTraceRK4_8C.html#a615dac8ee3d3e28f8224aa4f3131c701">pi</a></div><div class="ttdeci">const Double_t pi</div><div class="ttdef"><b>Definition:</b> <a href="RayTraceRK4_8C_source.html#l00012">RayTraceRK4.C:12</a></div></div>
<div class="ttc" id="RayTraceRK4_8C_html_aabbd1667d2631d1bf5e1302879450077"><div class="ttname"><a href="RayTraceRK4_8C.html#aabbd1667d2631d1bf5e1302879450077">h</a></div><div class="ttdeci">Double_t h</div><div class="ttdef"><b>Definition:</b> <a href="RayTraceRK4_8C_source.html#l00016">RayTraceRK4.C:16</a></div></div>
<div class="ttc" id="RayTraceRK4_8C_html_a973febe1d212427d73db10966b273af4"><div class="ttname"><a href="RayTraceRK4_8C.html#a973febe1d212427d73db10966b273af4">fz</a></div><div class="ttdeci">Double_t fz(Double_t theta)</div><div class="ttdoc">Takes in value of theta (angle w.r.t to the vertical) and calculates the derivative of depth z w...</div><div class="ttdef"><b>Definition:</b> <a href="RayTraceRK4_8C_source.html#l00904">RayTraceRK4.C:904</a></div></div>
<div class="ttc" id="RayTraceRK4_8C_html_a106442644474ea4220dbe0a18e159e86"><div class="ttname"><a href="RayTraceRK4_8C.html#a106442644474ea4220dbe0a18e159e86">ftime</a></div><div class="ttdeci">Double_t ftime(Double_t z)</div><div class="ttdoc">Takes in the value of depth z and calculates the derivative of time w.r.t to length of the step...</div><div class="ttdef"><b>Definition:</b> <a href="RayTraceRK4_8C_source.html#l00942">RayTraceRK4.C:942</a></div></div>
<div class="ttc" id="RayTraceRK4_8C_html_ab8e36e593e5ce8626d334c72466dbac6"><div class="ttname"><a href="RayTraceRK4_8C.html#ab8e36e593e5ce8626d334c72466dbac6">getAngleCorrections</a></div><div class="ttdeci">Double_t * getAngleCorrections(Int_t num, Int_t antco, Int_t D56co, Double_t test0, Double_t test1, Int_t psns, Int_t in, Int_t solnum)</div><div class="ttdoc">Takes in the value of Tx (x0,z0) and Rx (x1,z1) coordinates and corrects/adjusts the launch angles ba...</div><div class="ttdef"><b>Definition:</b> <a href="RayTraceRK4_8C_source.html#l01131">RayTraceRK4.C:1131</a></div></div>
<div class="ttc" id="RayTraceRK4_8C_html_abc2aaf8313c24c602356e10d240d82ee"><div class="ttname"><a href="RayTraceRK4_8C.html#abc2aaf8313c24c602356e10d240d82ee">ftheta</a></div><div class="ttdeci">Double_t ftheta(Double_t theta, Double_t z)</div><div class="ttdoc">Takes in value of theta (angle w.r.t to the vertical), n(z) and dndz(z) and calculates the derivative...</div><div class="ttdef"><b>Definition:</b> <a href="RayTraceRK4_8C_source.html#l00908">RayTraceRK4.C:908</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="RayTraceRK4_8C_ae524948803cf17eca25b0cd2ba17dc29_cgraph.png" border="0" usemap="#RayTraceRK4_8C_ae524948803cf17eca25b0cd2ba17dc29_cgraph" alt=""/></div>
<map name="RayTraceRK4_8C_ae524948803cf17eca25b0cd2ba17dc29_cgraph" id="RayTraceRK4_8C_ae524948803cf17eca25b0cd2ba17dc29_cgraph">
<area shape="rect" id="node2" href="RayTraceRK4_8C.html#a0b88e3189963924bcd9ec97027477b3d" title="Takes in the value of depth z and the frequency (in Ghz) and calculates the derivative of amplitude T..." alt="" coords="207,5,251,32"/>
<area shape="rect" id="node5" href="RayTraceRK4_8C.html#abc2aaf8313c24c602356e10d240d82ee" title="Takes in value of theta (angle w.r.t to the vertical), n(z) and dndz(z) and calculates the derivative..." alt="" coords="201,56,256,83"/>
<area shape="rect" id="node8" href="RayTraceRK4_8C.html#a106442644474ea4220dbe0a18e159e86" title="Takes in the value of depth z and calculates the derivative of time w.r.t to length of the step..." alt="" coords="365,157,415,184"/>
<area shape="rect" id="node9" href="RayTraceRK4_8C.html#a4e7aa57933d95efc32019bfc6bffd863" title="Takes in value of theta (angle w.r.t to the vertical) and calculates the derivative of x w..." alt="" coords="209,157,248,184"/>
<area shape="rect" id="node10" href="RayTraceRK4_8C.html#a973febe1d212427d73db10966b273af4" title="Takes in value of theta (angle w.r.t to the vertical) and calculates the derivative of depth z w..." alt="" coords="209,208,248,235"/>
<area shape="rect" id="node11" href="RayTraceRK4_8C.html#ab8e36e593e5ce8626d334c72466dbac6" title="Takes in the value of Tx (x0,z0) and Rx (x1,z1) coordinates and corrects/adjusts the launch angles ba..." alt="" coords="159,259,299,285"/>
<area shape="rect" id="node12" href="RayTraceRK4_8C.html#adbd350e958beadff13a5460dc9368740" title="Takes in the value of Tx (x0,z0) and Rx (x1,z1) coordinates and calculates a guess for the start laun..." alt="" coords="175,309,283,336"/>
<area shape="rect" id="node3" href="RayTraceRK4_8C.html#aae00660ff3fdd0b0d57389488f592539" title="Takes in value of frequency in Ghz and depth z and returns you the value of attenuation length..." alt="" coords="361,5,419,32"/>
<area shape="rect" id="node4" href="RayTraceRK4_8C.html#a7e8e798a5436285f3630ccce025dfb0e" title="Takes in value of depth z and returns the value of temperature. This is used in the RK4 calculations..." alt="" coords="481,5,572,32"/>
<area shape="rect" id="node6" href="RayTraceRK4_8C.html#ab9587d130691d8df4eb3f98349e286dc" title="Takes in values of A,B &amp; C and the depth z and returns value for the first derivative of refrative in..." alt="" coords="365,56,415,83"/>
<area shape="rect" id="node7" href="RayTraceRK4_8C.html#a1702994504683249f957d9824faa03ea" title="Takes in values of A,B &amp; C and the depth z and returns value for refrative index model n(z)..." alt="" coords="507,157,546,184"/>
<area shape="rect" id="node13" href="RayTraceRK4_8C.html#ae5e3f9f446f6172ec75e60456487ca3c" title="Takes in the value of Tx (x0,z0) and Rx (x1,z1) coordinates and calculates a guess for the launch ang..." alt="" coords="350,233,430,260"/>
<area shape="rect" id="node14" href="RayTraceRK4_8C.html#adf18e16d4be5e4e421640012a3356a38" title="Takes in the value of Tx (x0,z0) and Rx (x1,z1) coordinates and calculates a guess for the launch ang..." alt="" coords="347,309,433,336"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a615dac8ee3d3e28f8224aa4f3131c701"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a615dac8ee3d3e28f8224aa4f3131c701">&#9670;&nbsp;</a></span>pi</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const Double_t pi =4.0*atan(1.0)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p class="">Gives back value of Pi </p>

<p class="definition">Definition at line <a class="el" href="RayTraceRK4_8C_source.html#l00012">12</a> of file <a class="el" href="RayTraceRK4_8C_source.html">RayTraceRK4.C</a>.</p>

<p class="reference">Referenced by <a class="el" href="RayTraceRK4_8C_source.html#l01131">getAngleCorrections()</a>, <a class="el" href="RayTraceRK4_8C_source.html#l00947">getDirAng()</a>, <a class="el" href="RayTraceRK4_8C_source.html#l01179">getReflAng()</a>, <a class="el" href="RayTraceRK4_8C_source.html#l01050">getStartAngles()</a>, and <a class="el" href="RayTraceRK4_8C_source.html#l00183">RayTraceRK4()</a>.</p>

</div>
</div>
<a id="a4879d249821eef77017dddd45d973a84"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4879d249821eef77017dddd45d973a84">&#9670;&nbsp;</a></span>spedc</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const Double_t spedc =299792458.0</td>
        </tr>
      </table>
</div><div class="memdoc">
<p class="">Speed of Light in m/s </p>

<p class="definition">Definition at line <a class="el" href="RayTraceRK4_8C_source.html#l00014">14</a> of file <a class="el" href="RayTraceRK4_8C_source.html">RayTraceRK4.C</a>.</p>

<p class="reference">Referenced by <a class="el" href="RayTraceRK4_8C_source.html#l00942">ftime()</a>.</p>

</div>
</div>
<a id="aabbd1667d2631d1bf5e1302879450077"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aabbd1667d2631d1bf5e1302879450077">&#9670;&nbsp;</a></span>h</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Double_t h =1*utl::mm</td>
        </tr>
      </table>
</div><div class="memdoc">
<p class="">RK4 step size is set to 1mm </p>

<p class="definition">Definition at line <a class="el" href="RayTraceRK4_8C_source.html#l00016">16</a> of file <a class="el" href="RayTraceRK4_8C_source.html">RayTraceRK4.C</a>.</p>

<p class="reference">Referenced by <a class="el" href="RayTraceRK4_8C_source.html#l00947">getDirAng()</a>, and <a class="el" href="RayTraceRK4_8C_source.html#l00183">RayTraceRK4()</a>.</p>

</div>
</div>
<a id="a01087fe32e34ceaff1dcd8a4a1bafb5e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a01087fe32e34ceaff1dcd8a4a1bafb5e">&#9670;&nbsp;</a></span>tmax</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const Double_t tmax =10*utl::km</td>
        </tr>
      </table>
</div><div class="memdoc">
<p class="">Total "time" Rk4 will run for. In this case it is total meters before the RK4 loop stops if nothing else (i.e hitting the target or going out of scan region) stops it at first. </p>

<p class="definition">Definition at line <a class="el" href="RayTraceRK4_8C_source.html#l00018">18</a> of file <a class="el" href="RayTraceRK4_8C_source.html">RayTraceRK4.C</a>.</p>

<p class="reference">Referenced by <a class="el" href="RayTraceRK4_8C_source.html#l00183">RayTraceRK4()</a>.</p>

</div>
</div>
<a id="a7bee49b33affb6de35e7dd6787a7d1ff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7bee49b33affb6de35e7dd6787a7d1ff">&#9670;&nbsp;</a></span>A</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const Double_t A =1.78</td>
        </tr>
      </table>
</div><div class="memdoc">
<p class="">Value of Parameter A for SP model of refractive index </p>

<p class="definition">Definition at line <a class="el" href="RayTraceRK4_8C_source.html#l00020">20</a> of file <a class="el" href="RayTraceRK4_8C_source.html">RayTraceRK4.C</a>.</p>

<p class="reference">Referenced by <a class="el" href="RayTraceRK4_8C_source.html#l00947">getDirAng()</a>, and <a class="el" href="RayTraceRK4_8C_source.html#l00892">n()</a>.</p>

</div>
</div>
<a id="a3bff7602e1f23fa6422ebf501370116c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3bff7602e1f23fa6422ebf501370116c">&#9670;&nbsp;</a></span>B</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const Double_t B =-0.43</td>
        </tr>
      </table>
</div><div class="memdoc">
<p class="">Value of Parameter B for SP model of refractive index </p>

<p class="definition">Definition at line <a class="el" href="RayTraceRK4_8C_source.html#l00021">21</a> of file <a class="el" href="RayTraceRK4_8C_source.html">RayTraceRK4.C</a>.</p>

<p class="reference">Referenced by <a class="el" href="RayTraceRK4_8C_source.html#l00896">dndz()</a>, <a class="el" href="RayTraceRK4_8C_source.html#l00947">getDirAng()</a>, and <a class="el" href="RayTraceRK4_8C_source.html#l00892">n()</a>.</p>

</div>
</div>
<a id="aef13ddd41f7e49a80e7475962eecfb19"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef13ddd41f7e49a80e7475962eecfb19">&#9670;&nbsp;</a></span>C</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const Double_t C =0.0132</td>
        </tr>
      </table>
</div><div class="memdoc">
<p class="">Value of Parameter A for SP model of refractive index. There will be no negative sign for negative depth. </p>

<p class="definition">Definition at line <a class="el" href="RayTraceRK4_8C_source.html#l00022">22</a> of file <a class="el" href="RayTraceRK4_8C_source.html">RayTraceRK4.C</a>.</p>

<p class="reference">Referenced by <a class="el" href="RayTraceRK4_8C_source.html#l00896">dndz()</a>, <a class="el" href="RayTraceRK4_8C_source.html#l00947">getDirAng()</a>, and <a class="el" href="RayTraceRK4_8C_source.html#l00892">n()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="RayTraceRK4_8C.html">RayTraceRK4.C</a></li>
    <li class="footer">Generated on Thu Apr 19 2018 23:13:34 for Raytrace RK4 Code by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.15 </li>
  </ul>
</div>
</body>
</html>
